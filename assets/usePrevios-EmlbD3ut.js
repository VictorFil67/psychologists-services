import{j as v,p as bl,q as bt,r as y,t as Cl,v as Sl,S as eo,a as to,b as Me,l as no,w as wl,x as El,c as io,k as so,d as Il,i as xl,y as Tl,z as Rl,A as Ol,R as Vs,B as Pl,C as Nl,D as b,E as Ht,_ as Ml,F as kl,G as Al,H as Ll,I as Dl,J as Fl,K as $s,M as ee,N as Wi,O as Te,P as Vl,Q as $l,T as jl,U as ft,V as pn,W as Hi,X as Ut,Y as Dn,Z as Wl,$ as ro,a0 as oo,a1 as Hl,a2 as Ul,a3 as js,a4 as ao,a5 as Bl,a6 as ql,a7 as zl,a8 as Gl,a9 as Yl}from"./index-_bTKdxZD.js";function Kl(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}const Ql=t=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:26,height:26,fill:"none",...t,children:v.jsx("path",{stroke:"#191A15",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M22.577 4.994a5.959 5.959 0 0 0-8.429 0L13 6.142l-1.148-1.148a5.96 5.96 0 1 0-8.429 8.428l1.149 1.149L13 22.999l8.428-8.428 1.149-1.149a5.96 5.96 0 0 0 0-8.428Z"})}),Xl=t=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",...t,children:[v.jsx("circle",{cx:7,cy:7,r:7,fill:"#FBFBFB"}),v.jsx("circle",{cx:7,cy:7,r:4.667,fill:"#38CD3E"})]}),lo=t=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t,children:[v.jsx("g",{clipPath:"url(#a)",children:v.jsx("path",{fill:"#FFC531",stroke:"#FFC531",strokeWidth:1.2,d:"M6.2 4.697 8 1.286l1.8 3.411c.159.302.45.512.785.57l3.8.658-2.688 2.766a1.1 1.1 0 0 0-.3.923l.55 3.818-3.462-1.702a1.1 1.1 0 0 0-.97 0l-3.462 1.702.55-3.818a1.1 1.1 0 0 0-.3-.923L1.614 5.925l3.8-.657a1.1 1.1 0 0 0 .786-.571Z"})}),v.jsx("defs",{children:v.jsx("clipPath",{id:"a",children:v.jsx("path",{fill:"#fff",d:"M0 0h16v16H0z"})})})]}),Zl="_card_a6vgc_1",Jl="_cardImgWrap_a6vgc_37",ec="_svgOnline_a6vgc_59",tc="_cardImg_a6vgc_37",nc="_cardInfo_a6vgc_75",ic="_psychologist_a6vgc_109",sc="_cardInfoList_a6vgc_121",rc="_cardInfoItem_a6vgc_143",oc="_cardInfoText_a6vgc_193",ac="_price_a6vgc_215",lc="_heart_a6vgc_221",cc="_svgHeart_a6vgc_235",uc="_name_a6vgc_247",dc="_qualityList_a6vgc_275",hc="_qualityRow_a6vgc_287",fc="_quality_a6vgc_275",pc="_qualityName_a6vgc_319",mc="_qualityText_a6vgc_325",gc="_about_a6vgc_333",_c="_readMore_a6vgc_343",vc="_readMoreButton_a6vgc_351",L={card:Zl,cardImgWrap:Jl,svgOnline:ec,cardImg:tc,cardInfo:nc,psychologist:ic,cardInfoList:sc,cardInfoItem:rc,cardInfoText:oc,price:ac,heart:lc,svgHeart:cc,name:uc,qualityList:dc,qualityRow:hc,quality:fc,qualityName:pc,qualityText:mc,about:gc,readMore:_c,readMoreButton:vc},yc="_commentList_ukui0_1",bc="_reviewer_ukui0_21",Cc="_reviewerImg_ukui0_33",Sc="_avatar_ukui0_45",wc="_letter_ukui0_59",Ec="_name_ukui0_71",Ic="_rating_ukui0_79",xc="_comment_ukui0_1",Tc="_appointment_ukui0_103",qe={commentList:yc,reviewer:bc,reviewerImg:Cc,avatar:Sc,letter:wc,name:Ec,rating:Ic,comment:xc,appointment:Tc},Rc="_overlay_1aox4_1",Oc="_modal_1aox4_25",Pc="_CloseBtn_1aox4_63",Nc="_closeButton_1aox4_81",Mc="_title_1aox4_91",kc="_text_1aox4_133",Ac="_psychologistwrap_1aox4_167",Lc="_psychologistImg_1aox4_189",Dc="_psychologistInfo_1aox4_201",Fc="_yourPsychologist_1aox4_211",Vc="_name_1aox4_223",$c="_form_1aox4_235",jc="_input_1aox4_247",Wc="_time_1aox4_293",Hc="_error_1aox4_309",Uc="_box_1aox4_321",Bc="_inputBox_1aox4_353",qc="_textarea_1aox4_367",zc="_button_1aox4_413",$={overlay:Rc,modal:Oc,CloseBtn:Pc,closeButton:Nc,title:Mc,text:kc,psychologistwrap:Ac,psychologistImg:Lc,psychologistInfo:Dc,yourPsychologist:Fc,name:Vc,form:$c,input:jc,time:Wc,error:Hc,box:Uc,inputBox:Bc,textarea:qc,button:zc},Gc=bl({name:bt().max(32,"The name must contain a maximum of 32 characters").required("The name is required"),email:bt().email("Please write a valid email").matches(/^([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6}$/,"Please write a valid email").required("The email is required"),tel:bt().min(12,"The phone must contain a minimum of 12 characters").required("The phone is required"),time:bt().notOneOf(["00:00"],"Please specify the time").required("The time is required"),comment:bt().required("The comment is required")}),Yc=({close:t,name:e,avatar_url:n})=>{var h,f,p,m,g;const[i,s]=y.useState("00:00"),{register:r,handleSubmit:o,formState:{errors:l}}=Cl({mode:"onChange",resolver:Sl(Gc)});function a(_){console.log(_),alert(`You made the appointment with ${e} at ${_.time}`)}function c(_){_.target===_.currentTarget&&t()}document.addEventListener("keydown",u);function u(_){_.code==="Escape"&&(t(),document.removeEventListener("keydown",u))}function d(_){s(_.target.value)}return v.jsx("div",{className:$.overlay,onClick:c,children:v.jsxs("div",{className:$.modal,children:[v.jsx("button",{className:$.CloseBtn,onClick:t,"aria-label":"close",children:v.jsx(eo,{})}),v.jsx("h2",{className:$.title,"data-appointment":"",children:"Make an appointment with a psychologists"}),v.jsx("p",{className:$.text,"data-appointment":"",children:"You are on the verge of changing your life for the better. Fill out the short form below to book your personal appointment with a professional psychologist. We guarantee confidentiality and respect for your privacy."}),v.jsxs("div",{className:$.psychologistwrap,children:[v.jsx("img",{className:$.psychologistImg,src:n,alt:e,width:"44",height:"44"}),v.jsxs("div",{className:$.psychologistInfo,children:[v.jsx("p",{className:$.yourPsychologist,children:"Your psychologists"}),v.jsx("h3",{className:$.name,children:e})]})]}),v.jsxs("form",{className:$.form,onSubmit:o(a),children:[v.jsxs("div",{className:$.inputBox,children:[v.jsx("input",{className:$.input,...r("name"),type:"text",placeholder:"Name"}),v.jsx("span",{className:$.error,children:(h=l.name)==null?void 0:h.message})]}),v.jsxs("div",{className:$.box,children:[v.jsxs("div",{className:$.inputBox,children:[v.jsx("input",{className:$.input,...r("tel"),type:"text",placeholder:"+380"}),v.jsx("span",{className:$.error,children:(f=l.tel)==null?void 0:f.message})]}),v.jsxs("div",{className:$.inputBox,children:[v.jsx("input",{className:$.input+" "+$.time,...r("time"),type:"time",placeholder:"",value:i,onChange:d}),v.jsx("span",{className:$.error,children:(p=l.time)==null?void 0:p.message})]})]}),v.jsxs("div",{className:$.inputBox,children:[v.jsx("input",{className:$.input,...r("email"),type:"text",placeholder:"Email"}),v.jsx("span",{className:$.error,children:(m=l.email)==null?void 0:m.message})]}),v.jsxs("div",{className:$.inputBox,children:[v.jsx("textarea",{className:$.textarea,...r("comment"),placeholder:"Comment"}),v.jsx("span",{className:$.error,children:(g=l.comment)==null?void 0:g.message})]}),v.jsx("button",{className:$.button,type:"submit","aria-label":"Send",children:"Send"})]})]})})},Kc=({reviews:t,name:e,avatar_url:n})=>{const[i,s]=y.useState(!1);function r(){s(!0)}function o(){s(!1)}return y.useEffect(()=>{i?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[i]),v.jsxs(v.Fragment,{children:[i&&v.jsx(Yc,{close:o,name:e,avatar_url:n}),v.jsx("ul",{className:qe.commentList,children:t.map(({comment:l,rating:a,reviewer:c},u)=>v.jsxs("li",{children:[v.jsxs("div",{className:qe.reviewer,children:[v.jsx("div",{className:qe.avatar,children:v.jsx("span",{className:qe.letter,children:c.slice(0,1)})}),v.jsxs("div",{children:[v.jsx("h4",{className:qe.name,children:c}),v.jsxs("p",{className:qe.rating,children:[v.jsx(lo,{}),a]})]})]}),v.jsx("p",{className:qe.comment,children:l})]},u))}),v.jsx("button",{className:qe.appointment,onClick:r,"aria-label":"Make an appointment",children:"Make an appointment"})]})},Qc="_overlay_1ygar_1",Xc="_modal_1ygar_29",Zc="_closeButton_1ygar_59",oi={overlay:Qc,modal:Xc,closeButton:Zc},Jc=({close:t})=>{function e(i){i.target===i.currentTarget&&t()}document.addEventListener("keydown",n);function n(i){i.code==="Escape"&&(t(),document.removeEventListener("keydown",n))}return v.jsx("div",{className:oi.overlay,onClick:e,children:v.jsxs("div",{className:oi.modal,children:[v.jsx("button",{className:oi.closeButton,onClick:t,"aria-label":"close",children:v.jsx(eo,{})}),v.jsx("h1",{children:"No access! For authorized users only!"})]})})},Ws=({about:t,avatar_url:e,experience:n,initial_consultation:i,license:s,name:r,price_per_hour:o,rating:l,reviews:a,specialization:c,setCountFavorites:u})=>{const[d,h]=y.useState(!1),[f,p]=y.useState(!1),m=to(),_=Me(no).includes(e),C=Me(wl);function S(){p(!0)}function T(){p(!1)}function P(){u(),m(El(e))}return y.useEffect(()=>{f?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[f]),v.jsxs(v.Fragment,{children:[v.jsxs("li",{className:L.card,children:[v.jsxs("div",{className:L.cardImgWrap,children:[v.jsx(Xl,{className:L.svgOnline}),v.jsx("img",{className:L.cardImg,src:e,alt:r})]}),v.jsxs("div",{children:[v.jsxs("div",{className:L.cardInfo,children:[v.jsx("p",{className:L.psychologist,children:"Psychologist"}),v.jsxs("ul",{className:L.cardInfoList,children:[v.jsxs("li",{className:L.cardInfoItem,children:[v.jsx(lo,{}),v.jsxs("p",{className:L.cardInfoText,children:["Rating: ",v.jsx("span",{children:l})]})]}),v.jsx("li",{className:L.cardInfoItem,children:v.jsxs("p",{className:L.cardInfoText,children:["Price / 1 hour:"," ",v.jsxs("span",{className:L.price,children:[o,"$"]})]})}),v.jsx("li",{className:L.cardInfoItem,children:v.jsx("button",{className:L.heart,onClick:C?P:S,"aria-label":"add(remove) to(from) favorites",children:v.jsx(Ql,{className:_?L.svgHeart:""})})})]})]}),v.jsxs("h3",{className:L.name,children:[r," "]}),v.jsxs("div",{className:L.qualityList,children:[v.jsxs("ul",{className:L.qualityRow,children:[v.jsx("li",{className:L.quality,children:v.jsxs("p",{className:L.qualityName,children:["Experience:",v.jsx("span",{className:L.qualityText,children:n})]})}),v.jsx("li",{className:L.quality,children:v.jsxs("p",{className:L.qualityName,children:["License:",v.jsx("span",{className:L.qualityText,children:s})]})})]}),v.jsxs("ul",{className:L.qualityRow,children:[v.jsx("li",{className:L.quality,children:v.jsxs("p",{className:L.qualityName,children:["Specialization:",v.jsx("span",{className:L.qualityText,children:c})]})}),v.jsx("li",{className:L.quality,children:v.jsxs("p",{className:L.qualityName,children:["Initial_consultation:",v.jsx("span",{className:L.qualityText,children:i})]})})]})]}),v.jsx("p",{className:L.about,children:t}),d?v.jsx(Kc,{reviews:a,avatar_url:e,name:r}):v.jsx("button",{className:L.readMoreButton,onClick:h,"aria-label":"Read more",children:"Read more"})]})]}),f&&v.jsx(Jc,{close:T})]})},eu="_psychologistsList_179we_1",tu="_messageWrap_179we_29",nu="_message_179we_29",Jt={psychologistsList:eu,messageWrap:tu,message:nu},__=({location:t,setCountFavorites:e})=>{const n=Me(io),i=Me(so),s=Me(no);return v.jsx(v.Fragment,{children:t==="/favorites"?s.length?v.jsx("ul",{className:Jt.psychologistsList,children:i.map((r,o)=>v.jsx(Ws,{data:r,...r,setCountFavorites:e},o))}):v.jsx("div",{className:Jt.messageWrap,children:v.jsx("h1",{className:Jt.message,children:"You don`t have any favorite psychologists"})}):v.jsx("ul",{className:Jt.psychologistsList,children:n.map((r,o)=>v.jsx(Ws,{data:r,...r,setCountFavorites:e},o))})})},iu="_loadMoreWrap_p798a_1",su="_loadMore_p798a_1",en={loadMoreWrap:iu,loadMore:su},v_=({location:t})=>{const e=to(),n=Me(io),i=Me(Il),s=Me(xl),r=Me(so);return v.jsx(v.Fragment,{children:t==="/psychologists"?v.jsx("div",{className:en.loadMoreWrap,children:(n.length%3===0||n.length!==i.length)&&v.jsx("button",{className:en.loadMore,onClick:()=>e(Tl()),"aria-label":"Load more",children:"Load more"})}):t==="/favorites"&&v.jsx("div",{className:en.loadMoreWrap,children:r.length<s.length&&v.jsx("button",{className:en.loadMore,onClick:()=>e(Rl()),"aria-label":"Load more",children:"LoadMore"})})})};function Ze(t){"@babel/helpers - typeof";return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(t)}function ru(t,e){if(Ze(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Ze(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function co(t){var e=ru(t,"string");return Ze(e)=="symbol"?e:e+""}function Tt(t,e,n){return e=co(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,i)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Hs(Object(n),!0).forEach(function(i){Tt(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hs(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ou(t){if(Array.isArray(t))return t}function au(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,s,r,o,l=[],a=!0,c=!1;try{if(r=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;a=!1}else for(;!(a=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);a=!0);}catch(u){c=!0,s=u}finally{try{if(!a&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw s}}return l}}function Si(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function uo(t,e){if(t){if(typeof t=="string")return Si(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Si(t,e)}}function lu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ae(t,e){return ou(t)||au(t,e)||uo(t,e)||lu()}function cu(t,e){if(t==null)return{};var n={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function je(t,e){if(t==null)return{};var n=cu(t,e),i,s;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var uu=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function du(t){var e=t.defaultInputValue,n=e===void 0?"":e,i=t.defaultMenuIsOpen,s=i===void 0?!1:i,r=t.defaultValue,o=r===void 0?null:r,l=t.inputValue,a=t.menuIsOpen,c=t.onChange,u=t.onInputChange,d=t.onMenuClose,h=t.onMenuOpen,f=t.value,p=je(t,uu),m=y.useState(l!==void 0?l:n),g=Ae(m,2),_=g[0],C=g[1],S=y.useState(a!==void 0?a:s),T=Ae(S,2),P=T[0],O=T[1],w=y.useState(f!==void 0?f:o),N=Ae(w,2),q=N[0],ie=N[1],le=y.useCallback(function(_e,We){typeof c=="function"&&c(_e,We),ie(_e)},[c]),se=y.useCallback(function(_e,We){var He;typeof u=="function"&&(He=u(_e,We)),C(He!==void 0?He:_e)},[u]),Re=y.useCallback(function(){typeof h=="function"&&h(),O(!0)},[h]),Oe=y.useCallback(function(){typeof d=="function"&&d(),O(!1)},[d]),X=l!==void 0?l:_,Y=a!==void 0?a:P,we=f!==void 0?f:q;return I(I({},p),{},{inputValue:X,menuIsOpen:Y,onChange:le,onInputChange:se,onMenuClose:Oe,onMenuOpen:Re,value:we})}function x(){return x=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},x.apply(this,arguments)}function hu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Us(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,co(i.key),i)}}function fu(t,e,n){return e&&Us(t.prototype,e),n&&Us(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wi(t,e){return wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},wi(t,e)}function pu(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wi(t,e)}function mn(t){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mn(t)}function ho(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ho=function(){return!!t})()}function mu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gu(t,e){if(e&&(Ze(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mu(t)}function _u(t){var e=ho();return function(){var i=mn(t),s;if(e){var r=mn(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return gu(this,s)}}function vu(t){if(Array.isArray(t))return Si(t)}function yu(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ui(t){return vu(t)||yu(t)||uo(t)||bu()}function Cu(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Su(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var wu=function(){function t(n){var i=this;this._insertTag=function(s){var r;i.tags.length===0?i.insertionPoint?r=i.insertionPoint.nextSibling:i.prepend?r=i.container.firstChild:r=i.before:r=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(s,r),i.tags.push(s)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(i){i.forEach(this._insertTag)},e.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Su(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var r=Cu(s);try{r.insertRule(i,r.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(i));this.ctr++},e.flush=function(){this.tags.forEach(function(i){return i.parentNode&&i.parentNode.removeChild(i)}),this.tags=[],this.ctr=0},t}(),re="-ms-",gn="-moz-",D="-webkit-",fo="comm",Bi="rule",qi="decl",Eu="@import",po="@keyframes",Iu="@layer",xu=Math.abs,Fn=String.fromCharCode,Tu=Object.assign;function Ru(t,e){return ne(t,0)^45?(((e<<2^ne(t,0))<<2^ne(t,1))<<2^ne(t,2))<<2^ne(t,3):0}function mo(t){return t.trim()}function Ou(t,e){return(t=e.exec(t))?t[0]:t}function F(t,e,n){return t.replace(e,n)}function Ei(t,e){return t.indexOf(e)}function ne(t,e){return t.charCodeAt(e)|0}function kt(t,e,n){return t.slice(e,n)}function Ee(t){return t.length}function zi(t){return t.length}function tn(t,e){return e.push(t),t}function Pu(t,e){return t.map(e).join("")}var Vn=1,pt=1,go=0,de=0,G=0,_t="";function $n(t,e,n,i,s,r,o){return{value:t,root:e,parent:n,type:i,props:s,children:r,line:Vn,column:pt,length:o,return:""}}function Ct(t,e){return Tu($n("",null,null,"",null,null,0),t,{length:-t.length},e)}function Nu(){return G}function Mu(){return G=de>0?ne(_t,--de):0,pt--,G===10&&(pt=1,Vn--),G}function pe(){return G=de<go?ne(_t,de++):0,pt++,G===10&&(pt=1,Vn++),G}function xe(){return ne(_t,de)}function cn(){return de}function Bt(t,e){return kt(_t,t,e)}function At(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function _o(t){return Vn=pt=1,go=Ee(_t=t),de=0,[]}function vo(t){return _t="",t}function un(t){return mo(Bt(de-1,Ii(t===91?t+2:t===40?t+1:t)))}function ku(t){for(;(G=xe())&&G<33;)pe();return At(t)>2||At(G)>3?"":" "}function Au(t,e){for(;--e&&pe()&&!(G<48||G>102||G>57&&G<65||G>70&&G<97););return Bt(t,cn()+(e<6&&xe()==32&&pe()==32))}function Ii(t){for(;pe();)switch(G){case t:return de;case 34:case 39:t!==34&&t!==39&&Ii(G);break;case 40:t===41&&Ii(t);break;case 92:pe();break}return de}function Lu(t,e){for(;pe()&&t+G!==57;)if(t+G===84&&xe()===47)break;return"/*"+Bt(e,de-1)+"*"+Fn(t===47?t:pe())}function Du(t){for(;!At(xe());)pe();return Bt(t,de)}function Fu(t){return vo(dn("",null,null,null,[""],t=_o(t),0,[0],t))}function dn(t,e,n,i,s,r,o,l,a){for(var c=0,u=0,d=o,h=0,f=0,p=0,m=1,g=1,_=1,C=0,S="",T=s,P=r,O=i,w=S;g;)switch(p=C,C=pe()){case 40:if(p!=108&&ne(w,d-1)==58){Ei(w+=F(un(C),"&","&\f"),"&\f")!=-1&&(_=-1);break}case 34:case 39:case 91:w+=un(C);break;case 9:case 10:case 13:case 32:w+=ku(p);break;case 92:w+=Au(cn()-1,7);continue;case 47:switch(xe()){case 42:case 47:tn(Vu(Lu(pe(),cn()),e,n),a);break;default:w+="/"}break;case 123*m:l[c++]=Ee(w)*_;case 125*m:case 59:case 0:switch(C){case 0:case 125:g=0;case 59+u:_==-1&&(w=F(w,/\f/g,"")),f>0&&Ee(w)-d&&tn(f>32?qs(w+";",i,n,d-1):qs(F(w," ","")+";",i,n,d-2),a);break;case 59:w+=";";default:if(tn(O=Bs(w,e,n,c,u,s,l,S,T=[],P=[],d),r),C===123)if(u===0)dn(w,e,O,O,T,r,d,l,P);else switch(h===99&&ne(w,3)===110?100:h){case 100:case 108:case 109:case 115:dn(t,O,O,i&&tn(Bs(t,O,O,0,0,s,l,S,s,T=[],d),P),s,P,d,l,i?T:P);break;default:dn(w,O,O,O,[""],P,0,l,P)}}c=u=f=0,m=_=1,S=w="",d=o;break;case 58:d=1+Ee(w),f=p;default:if(m<1){if(C==123)--m;else if(C==125&&m++==0&&Mu()==125)continue}switch(w+=Fn(C),C*m){case 38:_=u>0?1:(w+="\f",-1);break;case 44:l[c++]=(Ee(w)-1)*_,_=1;break;case 64:xe()===45&&(w+=un(pe())),h=xe(),u=d=Ee(S=w+=Du(cn())),C++;break;case 45:p===45&&Ee(w)==2&&(m=0)}}return r}function Bs(t,e,n,i,s,r,o,l,a,c,u){for(var d=s-1,h=s===0?r:[""],f=zi(h),p=0,m=0,g=0;p<i;++p)for(var _=0,C=kt(t,d+1,d=xu(m=o[p])),S=t;_<f;++_)(S=mo(m>0?h[_]+" "+C:F(C,/&\f/g,h[_])))&&(a[g++]=S);return $n(t,e,n,s===0?Bi:l,a,c,u)}function Vu(t,e,n){return $n(t,e,n,fo,Fn(Nu()),kt(t,2,-2),0)}function qs(t,e,n,i){return $n(t,e,n,qi,kt(t,0,i),kt(t,i+1,-1),i)}function ut(t,e){for(var n="",i=zi(t),s=0;s<i;s++)n+=e(t[s],s,t,e)||"";return n}function $u(t,e,n,i){switch(t.type){case Iu:if(t.children.length)break;case Eu:case qi:return t.return=t.return||t.value;case fo:return"";case po:return t.return=t.value+"{"+ut(t.children,i)+"}";case Bi:t.value=t.props.join(",")}return Ee(n=ut(t.children,i))?t.return=t.value+"{"+n+"}":""}function ju(t){var e=zi(t);return function(n,i,s,r){for(var o="",l=0;l<e;l++)o+=t[l](n,i,s,r)||"";return o}}function Wu(t){return function(e){e.root||(e=e.return)&&t(e)}}var Hu=function(e,n,i){for(var s=0,r=0;s=r,r=xe(),s===38&&r===12&&(n[i]=1),!At(r);)pe();return Bt(e,de)},Uu=function(e,n){var i=-1,s=44;do switch(At(s)){case 0:s===38&&xe()===12&&(n[i]=1),e[i]+=Hu(de-1,n,i);break;case 2:e[i]+=un(s);break;case 4:if(s===44){e[++i]=xe()===58?"&\f":"",n[i]=e[i].length;break}default:e[i]+=Fn(s)}while(s=pe());return e},Bu=function(e,n){return vo(Uu(_o(e),n))},zs=new WeakMap,qu=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,i=e.parent,s=e.column===i.column&&e.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!zs.get(i))&&!s){zs.set(e,!0);for(var r=[],o=Bu(n,r),l=i.props,a=0,c=0;a<o.length;a++)for(var u=0;u<l.length;u++,c++)e.props[c]=r[a]?o[a].replace(/&\f/g,l[u]):l[u]+" "+o[a]}}},zu=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function yo(t,e){switch(Ru(t,e)){case 5103:return D+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return D+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return D+t+gn+t+re+t+t;case 6828:case 4268:return D+t+re+t+t;case 6165:return D+t+re+"flex-"+t+t;case 5187:return D+t+F(t,/(\w+).+(:[^]+)/,D+"box-$1$2"+re+"flex-$1$2")+t;case 5443:return D+t+re+"flex-item-"+F(t,/flex-|-self/,"")+t;case 4675:return D+t+re+"flex-line-pack"+F(t,/align-content|flex-|-self/,"")+t;case 5548:return D+t+re+F(t,"shrink","negative")+t;case 5292:return D+t+re+F(t,"basis","preferred-size")+t;case 6060:return D+"box-"+F(t,"-grow","")+D+t+re+F(t,"grow","positive")+t;case 4554:return D+F(t,/([^-])(transform)/g,"$1"+D+"$2")+t;case 6187:return F(F(F(t,/(zoom-|grab)/,D+"$1"),/(image-set)/,D+"$1"),t,"")+t;case 5495:case 3959:return F(t,/(image-set\([^]*)/,D+"$1$`$1");case 4968:return F(F(t,/(.+:)(flex-)?(.*)/,D+"box-pack:$3"+re+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+D+t+t;case 4095:case 3583:case 4068:case 2532:return F(t,/(.+)-inline(.+)/,D+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ee(t)-1-e>6)switch(ne(t,e+1)){case 109:if(ne(t,e+4)!==45)break;case 102:return F(t,/(.+:)(.+)-([^]+)/,"$1"+D+"$2-$3$1"+gn+(ne(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Ei(t,"stretch")?yo(F(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(ne(t,e+1)!==115)break;case 6444:switch(ne(t,Ee(t)-3-(~Ei(t,"!important")&&10))){case 107:return F(t,":",":"+D)+t;case 101:return F(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+D+(ne(t,14)===45?"inline-":"")+"box$3$1"+D+"$2$3$1"+re+"$2box$3")+t}break;case 5936:switch(ne(t,e+11)){case 114:return D+t+re+F(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return D+t+re+F(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return D+t+re+F(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return D+t+re+t+t}return t}var Gu=function(e,n,i,s){if(e.length>-1&&!e.return)switch(e.type){case qi:e.return=yo(e.value,e.length);break;case po:return ut([Ct(e,{value:F(e.value,"@","@"+D)})],s);case Bi:if(e.length)return Pu(e.props,function(r){switch(Ou(r,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ut([Ct(e,{props:[F(r,/:(read-\w+)/,":"+gn+"$1")]})],s);case"::placeholder":return ut([Ct(e,{props:[F(r,/:(plac\w+)/,":"+D+"input-$1")]}),Ct(e,{props:[F(r,/:(plac\w+)/,":"+gn+"$1")]}),Ct(e,{props:[F(r,/:(plac\w+)/,re+"input-$1")]})],s)}return""})}},Yu=[Gu],Ku=function(e){var n=e.key;if(n==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var s=e.stylisPlugins||Yu,r={},o,l=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),_=1;_<g.length;_++)r[g[_]]=!0;l.push(m)});var a,c=[qu,zu];{var u,d=[$u,Wu(function(m){u.insert(m)})],h=ju(c.concat(s,d)),f=function(g){return ut(Fu(g),h)};a=function(g,_,C,S){u=C,f(g?g+"{"+_.styles+"}":_.styles),S&&(p.inserted[_.name]=!0)}}var p={key:n,sheet:new wu({key:n,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:r,registered:{},insert:a};return p.sheet.hydrate(l),p},bo={exports:{}},j={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=typeof Symbol=="function"&&Symbol.for,Gi=te?Symbol.for("react.element"):60103,Yi=te?Symbol.for("react.portal"):60106,jn=te?Symbol.for("react.fragment"):60107,Wn=te?Symbol.for("react.strict_mode"):60108,Hn=te?Symbol.for("react.profiler"):60114,Un=te?Symbol.for("react.provider"):60109,Bn=te?Symbol.for("react.context"):60110,Ki=te?Symbol.for("react.async_mode"):60111,qn=te?Symbol.for("react.concurrent_mode"):60111,zn=te?Symbol.for("react.forward_ref"):60112,Gn=te?Symbol.for("react.suspense"):60113,Qu=te?Symbol.for("react.suspense_list"):60120,Yn=te?Symbol.for("react.memo"):60115,Kn=te?Symbol.for("react.lazy"):60116,Xu=te?Symbol.for("react.block"):60121,Zu=te?Symbol.for("react.fundamental"):60117,Ju=te?Symbol.for("react.responder"):60118,ed=te?Symbol.for("react.scope"):60119;function ge(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Gi:switch(t=t.type,t){case Ki:case qn:case jn:case Hn:case Wn:case Gn:return t;default:switch(t=t&&t.$$typeof,t){case Bn:case zn:case Kn:case Yn:case Un:return t;default:return e}}case Yi:return e}}}function Co(t){return ge(t)===qn}j.AsyncMode=Ki;j.ConcurrentMode=qn;j.ContextConsumer=Bn;j.ContextProvider=Un;j.Element=Gi;j.ForwardRef=zn;j.Fragment=jn;j.Lazy=Kn;j.Memo=Yn;j.Portal=Yi;j.Profiler=Hn;j.StrictMode=Wn;j.Suspense=Gn;j.isAsyncMode=function(t){return Co(t)||ge(t)===Ki};j.isConcurrentMode=Co;j.isContextConsumer=function(t){return ge(t)===Bn};j.isContextProvider=function(t){return ge(t)===Un};j.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gi};j.isForwardRef=function(t){return ge(t)===zn};j.isFragment=function(t){return ge(t)===jn};j.isLazy=function(t){return ge(t)===Kn};j.isMemo=function(t){return ge(t)===Yn};j.isPortal=function(t){return ge(t)===Yi};j.isProfiler=function(t){return ge(t)===Hn};j.isStrictMode=function(t){return ge(t)===Wn};j.isSuspense=function(t){return ge(t)===Gn};j.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===jn||t===qn||t===Hn||t===Wn||t===Gn||t===Qu||typeof t=="object"&&t!==null&&(t.$$typeof===Kn||t.$$typeof===Yn||t.$$typeof===Un||t.$$typeof===Bn||t.$$typeof===zn||t.$$typeof===Zu||t.$$typeof===Ju||t.$$typeof===ed||t.$$typeof===Xu)};j.typeOf=ge;bo.exports=j;var td=bo.exports,So=td,nd={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},id={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},wo={};wo[So.ForwardRef]=nd;wo[So.Memo]=id;var sd=!0;function rd(t,e,n){var i="";return n.split(" ").forEach(function(s){t[s]!==void 0?e.push(t[s]+";"):i+=s+" "}),i}var Eo=function(e,n,i){var s=e.key+"-"+n.name;(i===!1||sd===!1)&&e.registered[s]===void 0&&(e.registered[s]=n.styles)},od=function(e,n,i){Eo(e,n,i);var s=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var r=n;do e.insert(n===r?"."+s:"",r,e.sheet,!0),r=r.next;while(r!==void 0)}};function ad(t){for(var e=0,n,i=0,s=t.length;s>=4;++i,s-=4)n=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(t.charCodeAt(i+2)&255)<<16;case 2:e^=(t.charCodeAt(i+1)&255)<<8;case 1:e^=t.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var ld=/[A-Z]|^ms/g,cd=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Io=function(e){return e.charCodeAt(1)===45},Gs=function(e){return e!=null&&typeof e!="boolean"},ai=Kl(function(t){return Io(t)?t:t.replace(ld,"-$&").toLowerCase()}),Ys=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(cd,function(i,s,r){return Ie={name:s,styles:r,next:Ie},s})}return Ol[e]!==1&&!Io(e)&&typeof n=="number"&&n!==0?n+"px":n};function Lt(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Ie={name:n.name,styles:n.styles,next:Ie},n.name;if(n.styles!==void 0){var i=n.next;if(i!==void 0)for(;i!==void 0;)Ie={name:i.name,styles:i.styles,next:Ie},i=i.next;var s=n.styles+";";return s}return ud(t,e,n)}case"function":{if(t!==void 0){var r=Ie,o=n(t);return Ie=r,Lt(t,e,o)}break}}return n}function ud(t,e,n){var i="";if(Array.isArray(n))for(var s=0;s<n.length;s++)i+=Lt(t,e,n[s])+";";else for(var r in n){var o=n[r];if(typeof o!="object")Gs(o)&&(i+=ai(r)+":"+Ys(r,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&e==null)for(var l=0;l<o.length;l++)Gs(o[l])&&(i+=ai(r)+":"+Ys(r,o[l])+";");else{var a=Lt(t,e,o);switch(r){case"animation":case"animationName":{i+=ai(r)+":"+a+";";break}default:i+=r+"{"+a+"}"}}}return i}var Ks=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Ie,xo=function(e,n,i){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,r="";Ie=void 0;var o=e[0];o==null||o.raw===void 0?(s=!1,r+=Lt(i,n,o)):r+=o[0];for(var l=1;l<e.length;l++)r+=Lt(i,n,e[l]),s&&(r+=o[l]);Ks.lastIndex=0;for(var a="",c;(c=Ks.exec(r))!==null;)a+="-"+c[1];var u=ad(r)+a;return{name:u,styles:r,next:Ie}},dd=function(e){return e()},hd=Vs.useInsertionEffect?Vs.useInsertionEffect:!1,fd=hd||dd,Qi={}.hasOwnProperty,To=y.createContext(typeof HTMLElement<"u"?Ku({key:"css"}):null);To.Provider;var pd=function(e){return y.forwardRef(function(n,i){var s=y.useContext(To);return e(n,s,i)})},md=y.createContext({}),xi="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",gd=function(e,n){var i={};for(var s in n)Qi.call(n,s)&&(i[s]=n[s]);return i[xi]=e,i},_d=function(e){var n=e.cache,i=e.serialized,s=e.isStringTag;return Eo(n,i,s),fd(function(){return od(n,i,s)}),null},vd=pd(function(t,e,n){var i=t.css;typeof i=="string"&&e.registered[i]!==void 0&&(i=e.registered[i]);var s=t[xi],r=[i],o="";typeof t.className=="string"?o=rd(e.registered,r,t.className):t.className!=null&&(o=t.className+" ");var l=xo(r,void 0,y.useContext(md));o+=e.key+"-"+l.name;var a={};for(var c in t)Qi.call(t,c)&&c!=="css"&&c!==xi&&(a[c]=t[c]);return a.ref=n,a.className=o,y.createElement(y.Fragment,null,y.createElement(_d,{cache:e,serialized:l,isStringTag:typeof s=="string"}),y.createElement(s,a))}),yd=vd,E=function(e,n){var i=arguments;if(n==null||!Qi.call(n,"css"))return y.createElement.apply(void 0,i);var s=i.length,r=new Array(s);r[0]=yd,r[1]=gd(e,n);for(var o=2;o<s;o++)r[o]=i[o];return y.createElement.apply(null,r)};function Xi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xo(e)}var bd=function(){var e=Xi.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function Cd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Sd=Math.min,wd=Math.max,_n=Math.round,nn=Math.floor,vn=t=>({x:t,y:t});function Ed(t){const{x:e,y:n,width:i,height:s}=t;return{width:i,height:s,top:n,left:e,right:e+i,bottom:n+s,x:e,y:n}}function Ro(t){return Po(t)?(t.nodeName||"").toLowerCase():"#document"}function Fe(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Oo(t){var e;return(e=(Po(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Po(t){return t instanceof Node||t instanceof Fe(t).Node}function Id(t){return t instanceof Element||t instanceof Fe(t).Element}function Zi(t){return t instanceof HTMLElement||t instanceof Fe(t).HTMLElement}function Qs(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Fe(t).ShadowRoot}function No(t){const{overflow:e,overflowX:n,overflowY:i,display:s}=Ji(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(s)}function xd(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Td(t){return["html","body","#document"].includes(Ro(t))}function Ji(t){return Fe(t).getComputedStyle(t)}function Rd(t){if(Ro(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Qs(t)&&t.host||Oo(t);return Qs(e)?e.host:e}function Mo(t){const e=Rd(t);return Td(e)?t.ownerDocument?t.ownerDocument.body:t.body:Zi(e)&&No(e)?e:Mo(e)}function yn(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=Mo(t),r=s===((i=t.ownerDocument)==null?void 0:i.body),o=Fe(s);return r?e.concat(o,o.visualViewport||[],No(s)?s:[],o.frameElement&&n?yn(o.frameElement):[]):e.concat(s,yn(s,[],n))}function Od(t){const e=Ji(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const s=Zi(t),r=s?t.offsetWidth:n,o=s?t.offsetHeight:i,l=_n(n)!==r||_n(i)!==o;return l&&(n=r,i=o),{width:n,height:i,$:l}}function es(t){return Id(t)?t:t.contextElement}function Xs(t){const e=es(t);if(!Zi(e))return vn(1);const n=e.getBoundingClientRect(),{width:i,height:s,$:r}=Od(e);let o=(r?_n(n.width):n.width)/i,l=(r?_n(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Pd=vn(0);function Nd(t){const e=Fe(t);return!xd()||!e.visualViewport?Pd:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Md(t,e,n){return!1}function Zs(t,e,n,i){e===void 0&&(e=!1);const s=t.getBoundingClientRect(),r=es(t);let o=vn(1);e&&(o=Xs(t));const l=Md()?Nd(r):vn(0);let a=(s.left+l.x)/o.x,c=(s.top+l.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(r){const h=Fe(r),f=i;let p=h,m=p.frameElement;for(;m&&i&&f!==p;){const g=Xs(m),_=m.getBoundingClientRect(),C=Ji(m),S=_.left+(m.clientLeft+parseFloat(C.paddingLeft))*g.x,T=_.top+(m.clientTop+parseFloat(C.paddingTop))*g.y;a*=g.x,c*=g.y,u*=g.x,d*=g.y,a+=S,c+=T,p=Fe(m),m=p.frameElement}}return Ed({width:u,height:d,x:a,y:c})}function kd(t,e){let n=null,i;const s=Oo(t);function r(){var l;clearTimeout(i),(l=n)==null||l.disconnect(),n=null}function o(l,a){l===void 0&&(l=!1),a===void 0&&(a=1),r();const{left:c,top:u,width:d,height:h}=t.getBoundingClientRect();if(l||e(),!d||!h)return;const f=nn(u),p=nn(s.clientWidth-(c+d)),m=nn(s.clientHeight-(u+h)),g=nn(c),C={rootMargin:-f+"px "+-p+"px "+-m+"px "+-g+"px",threshold:wd(0,Sd(1,a))||1};let S=!0;function T(P){const O=P[0].intersectionRatio;if(O!==a){if(!S)return o();O?o(!1,O):i=setTimeout(()=>{o(!1,1e-7)},1e3)}S=!1}try{n=new IntersectionObserver(T,{...C,root:s.ownerDocument})}catch{n=new IntersectionObserver(T,C)}n.observe(t)}return o(!0),r}function Ad(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:a=!1}=i,c=es(t),u=s||r?[...c?yn(c):[],...yn(e)]:[];u.forEach(_=>{s&&_.addEventListener("scroll",n,{passive:!0}),r&&_.addEventListener("resize",n)});const d=c&&l?kd(c,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(_=>{let[C]=_;C&&C.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=f)==null||S.observe(e)})),n()}),c&&!a&&f.observe(c),f.observe(e));let p,m=a?Zs(t):null;a&&g();function g(){const _=Zs(t);m&&(_.x!==m.x||_.y!==m.y||_.width!==m.width||_.height!==m.height)&&n(),m=_,p=requestAnimationFrame(g)}return n(),()=>{var _;u.forEach(C=>{s&&C.removeEventListener("scroll",n),r&&C.removeEventListener("resize",n)}),d==null||d(),(_=f)==null||_.disconnect(),f=null,a&&cancelAnimationFrame(p)}}var Ti=y.useLayoutEffect,Ld=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],bn=function(){};function Dd(t,e){return e?e[0]==="-"?t+e:t+"__"+e:t}function Fd(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var r=[].concat(i);if(e&&t)for(var o in e)e.hasOwnProperty(o)&&e[o]&&r.push("".concat(Dd(t,o)));return r.filter(function(l){return l}).map(function(l){return String(l).trim()}).join(" ")}var Js=function(e){return zd(e)?e.filter(Boolean):Ze(e)==="object"&&e!==null?[e]:[]},ko=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var n=je(e,Ld);return I({},n)},z=function(e,n,i){var s=e.cx,r=e.getStyles,o=e.getClassNames,l=e.className;return{css:r(n,e),className:s(i??{},o(n,e),l)}};function Qn(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function Vd(t){return Qn(t)?window.innerHeight:t.clientHeight}function Ao(t){return Qn(t)?window.pageYOffset:t.scrollTop}function Cn(t,e){if(Qn(t)){window.scrollTo(0,e);return}t.scrollTop=e}function $d(t){var e=getComputedStyle(t),n=e.position==="absolute",i=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var s=t;s=s.parentElement;)if(e=getComputedStyle(s),!(n&&e.position==="static")&&i.test(e.overflow+e.overflowY+e.overflowX))return s;return document.documentElement}function jd(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e}function sn(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:bn,s=Ao(t),r=e-s,o=10,l=0;function a(){l+=o;var c=jd(l,s,r,n);Cn(t,c),l<n?window.requestAnimationFrame(a):i(t)}a()}function er(t,e){var n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),s=e.offsetHeight/3;i.bottom+s>n.bottom?Cn(t,Math.min(e.offsetTop+e.clientHeight-t.offsetHeight+s,t.scrollHeight)):i.top-s<n.top&&Cn(t,Math.max(e.offsetTop-s,0))}function Wd(t){var e=t.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function tr(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function Hd(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Lo=!1,Ud={get passive(){return Lo=!0}},rn=typeof window<"u"?window:{};rn.addEventListener&&rn.removeEventListener&&(rn.addEventListener("p",bn,Ud),rn.removeEventListener("p",bn,!1));var Bd=Lo;function qd(t){return t!=null}function zd(t){return Array.isArray(t)}function on(t,e,n){return t?e:n}var Gd=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var r=Object.entries(e).filter(function(o){var l=Ae(o,1),a=l[0];return!i.includes(a)});return r.reduce(function(o,l){var a=Ae(l,2),c=a[0],u=a[1];return o[c]=u,o},{})},Yd=["children","innerProps"],Kd=["children","innerProps"];function Qd(t){var e=t.maxHeight,n=t.menuEl,i=t.minHeight,s=t.placement,r=t.shouldScroll,o=t.isFixedPosition,l=t.controlHeight,a=$d(n),c={placement:"bottom",maxHeight:e};if(!n||!n.offsetParent)return c;var u=a.getBoundingClientRect(),d=u.height,h=n.getBoundingClientRect(),f=h.bottom,p=h.height,m=h.top,g=n.offsetParent.getBoundingClientRect(),_=g.top,C=o?window.innerHeight:Vd(a),S=Ao(a),T=parseInt(getComputedStyle(n).marginBottom,10),P=parseInt(getComputedStyle(n).marginTop,10),O=_-P,w=C-m,N=O+S,q=d-S-m,ie=f-C+S+T,le=S+m-P,se=160;switch(s){case"auto":case"bottom":if(w>=p)return{placement:"bottom",maxHeight:e};if(q>=p&&!o)return r&&sn(a,ie,se),{placement:"bottom",maxHeight:e};if(!o&&q>=i||o&&w>=i){r&&sn(a,ie,se);var Re=o?w-T:q-T;return{placement:"bottom",maxHeight:Re}}if(s==="auto"||o){var Oe=e,X=o?O:N;return X>=i&&(Oe=Math.min(X-T-l,e)),{placement:"top",maxHeight:Oe}}if(s==="bottom")return r&&Cn(a,ie),{placement:"bottom",maxHeight:e};break;case"top":if(O>=p)return{placement:"top",maxHeight:e};if(N>=p&&!o)return r&&sn(a,le,se),{placement:"top",maxHeight:e};if(!o&&N>=i||o&&O>=i){var Y=e;return(!o&&N>=i||o&&O>=i)&&(Y=o?O-P:N-P),r&&sn(a,le,se),{placement:"top",maxHeight:Y}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(s,'".'))}return c}function Xd(t){var e={bottom:"top",top:"bottom"};return t?e[t]:"bottom"}var Do=function(e){return e==="auto"?"bottom":e},Zd=function(e,n){var i,s=e.placement,r=e.theme,o=r.borderRadius,l=r.spacing,a=r.colors;return I((i={label:"menu"},Tt(i,Xd(s),"100%"),Tt(i,"position","absolute"),Tt(i,"width","100%"),Tt(i,"zIndex",1),i),n?{}:{backgroundColor:a.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:l.menuGutter,marginTop:l.menuGutter})},Fo=y.createContext(null),Jd=function(e){var n=e.children,i=e.minMenuHeight,s=e.maxMenuHeight,r=e.menuPlacement,o=e.menuPosition,l=e.menuShouldScrollIntoView,a=e.theme,c=y.useContext(Fo)||{},u=c.setPortalPlacement,d=y.useRef(null),h=y.useState(s),f=Ae(h,2),p=f[0],m=f[1],g=y.useState(null),_=Ae(g,2),C=_[0],S=_[1],T=a.spacing.controlHeight;return Ti(function(){var P=d.current;if(P){var O=o==="fixed",w=l&&!O,N=Qd({maxHeight:s,menuEl:P,minHeight:i,placement:r,shouldScroll:w,isFixedPosition:O,controlHeight:T});m(N.maxHeight),S(N.placement),u==null||u(N.placement)}},[s,r,o,l,i,u,T]),n({ref:d,placerProps:I(I({},e),{},{placement:C||Do(r),maxHeight:p})})},eh=function(e){var n=e.children,i=e.innerRef,s=e.innerProps;return E("div",x({},z(e,"menu",{menu:!0}),{ref:i},s),n)},th=eh,nh=function(e,n){var i=e.maxHeight,s=e.theme.spacing.baseUnit;return I({maxHeight:i,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:s,paddingTop:s})},ih=function(e){var n=e.children,i=e.innerProps,s=e.innerRef,r=e.isMulti;return E("div",x({},z(e,"menuList",{"menu-list":!0,"menu-list--is-multi":r}),{ref:s},i),n)},Vo=function(e,n){var i=e.theme,s=i.spacing.baseUnit,r=i.colors;return I({textAlign:"center"},n?{}:{color:r.neutral40,padding:"".concat(s*2,"px ").concat(s*3,"px")})},sh=Vo,rh=Vo,oh=function(e){var n=e.children,i=n===void 0?"No options":n,s=e.innerProps,r=je(e,Yd);return E("div",x({},z(I(I({},r),{},{children:i,innerProps:s}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),i)},ah=function(e){var n=e.children,i=n===void 0?"Loading...":n,s=e.innerProps,r=je(e,Kd);return E("div",x({},z(I(I({},r),{},{children:i,innerProps:s}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),i)},lh=function(e){var n=e.rect,i=e.offset,s=e.position;return{left:n.left,position:s,top:i,width:n.width,zIndex:1}},ch=function(e){var n=e.appendTo,i=e.children,s=e.controlElement,r=e.innerProps,o=e.menuPlacement,l=e.menuPosition,a=y.useRef(null),c=y.useRef(null),u=y.useState(Do(o)),d=Ae(u,2),h=d[0],f=d[1],p=y.useMemo(function(){return{setPortalPlacement:f}},[]),m=y.useState(null),g=Ae(m,2),_=g[0],C=g[1],S=y.useCallback(function(){if(s){var w=Wd(s),N=l==="fixed"?0:window.pageYOffset,q=w[h]+N;(q!==(_==null?void 0:_.offset)||w.left!==(_==null?void 0:_.rect.left)||w.width!==(_==null?void 0:_.rect.width))&&C({offset:q,rect:w})}},[s,l,h,_==null?void 0:_.offset,_==null?void 0:_.rect.left,_==null?void 0:_.rect.width]);Ti(function(){S()},[S]);var T=y.useCallback(function(){typeof c.current=="function"&&(c.current(),c.current=null),s&&a.current&&(c.current=Ad(s,a.current,S,{elementResize:"ResizeObserver"in window}))},[s,S]);Ti(function(){T()},[T]);var P=y.useCallback(function(w){a.current=w,T()},[T]);if(!n&&l!=="fixed"||!_)return null;var O=E("div",x({ref:P},z(I(I({},e),{},{offset:_.offset,position:l,rect:_.rect}),"menuPortal",{"menu-portal":!0}),r),i);return E(Fo.Provider,{value:p},n?Pl.createPortal(O,n):O)},uh=function(e){var n=e.isDisabled,i=e.isRtl;return{label:"container",direction:i?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},dh=function(e){var n=e.children,i=e.innerProps,s=e.isDisabled,r=e.isRtl;return E("div",x({},z(e,"container",{"--is-disabled":s,"--is-rtl":r}),i),n)},hh=function(e,n){var i=e.theme.spacing,s=e.isMulti,r=e.hasValue,o=e.selectProps.controlShouldRenderValue;return I({alignItems:"center",display:s&&r&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px")})},fh=function(e){var n=e.children,i=e.innerProps,s=e.isMulti,r=e.hasValue;return E("div",x({},z(e,"valueContainer",{"value-container":!0,"value-container--is-multi":s,"value-container--has-value":r}),i),n)},ph=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},mh=function(e){var n=e.children,i=e.innerProps;return E("div",x({},z(e,"indicatorsContainer",{indicators:!0}),i),n)},nr,gh=["size"],_h=["innerProps","isRtl","size"],vh={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},$o=function(e){var n=e.size,i=je(e,gh);return E("svg",x({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:vh},i))},ts=function(e){return E($o,x({size:20},e),E("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},jo=function(e){return E($o,x({size:20},e),E("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Wo=function(e,n){var i=e.isFocused,s=e.theme,r=s.spacing.baseUnit,o=s.colors;return I({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:i?o.neutral60:o.neutral20,padding:r*2,":hover":{color:i?o.neutral80:o.neutral40}})},yh=Wo,bh=function(e){var n=e.children,i=e.innerProps;return E("div",x({},z(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),i),n||E(jo,null))},Ch=Wo,Sh=function(e){var n=e.children,i=e.innerProps;return E("div",x({},z(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),i),n||E(ts,null))},wh=function(e,n){var i=e.isDisabled,s=e.theme,r=s.spacing.baseUnit,o=s.colors;return I({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:i?o.neutral10:o.neutral20,marginBottom:r*2,marginTop:r*2})},Eh=function(e){var n=e.innerProps;return E("span",x({},n,z(e,"indicatorSeparator",{"indicator-separator":!0})))},Ih=bd(nr||(nr=Cd([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),xh=function(e,n){var i=e.isFocused,s=e.size,r=e.theme,o=r.colors,l=r.spacing.baseUnit;return I({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:s,lineHeight:1,marginRight:s,textAlign:"center",verticalAlign:"middle"},n?{}:{color:i?o.neutral60:o.neutral20,padding:l*2})},li=function(e){var n=e.delay,i=e.offset;return E("span",{css:Xi({animation:"".concat(Ih," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:i?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Th=function(e){var n=e.innerProps,i=e.isRtl,s=e.size,r=s===void 0?4:s,o=je(e,_h);return E("div",x({},z(I(I({},o),{},{innerProps:n,isRtl:i,size:r}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),E(li,{delay:0,offset:i}),E(li,{delay:160,offset:!0}),E(li,{delay:320,offset:!i}))},Rh=function(e,n){var i=e.isDisabled,s=e.isFocused,r=e.theme,o=r.colors,l=r.borderRadius,a=r.spacing;return I({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:a.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:i?o.neutral5:o.neutral0,borderColor:i?o.neutral10:s?o.primary:o.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:s?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:s?o.primary:o.neutral30}})},Oh=function(e){var n=e.children,i=e.isDisabled,s=e.isFocused,r=e.innerRef,o=e.innerProps,l=e.menuIsOpen;return E("div",x({ref:r},z(e,"control",{control:!0,"control--is-disabled":i,"control--is-focused":s,"control--menu-is-open":l}),o,{"aria-disabled":i||void 0}),n)},Ph=Oh,Nh=["data"],Mh=function(e,n){var i=e.theme.spacing;return n?{}:{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},kh=function(e){var n=e.children,i=e.cx,s=e.getStyles,r=e.getClassNames,o=e.Heading,l=e.headingProps,a=e.innerProps,c=e.label,u=e.theme,d=e.selectProps;return E("div",x({},z(e,"group",{group:!0}),a),E(o,x({},l,{selectProps:d,theme:u,getStyles:s,getClassNames:r,cx:i}),c),E("div",null,n))},Ah=function(e,n){var i=e.theme,s=i.colors,r=i.spacing;return I({label:"group",cursor:"default",display:"block"},n?{}:{color:s.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:r.baseUnit*3,paddingRight:r.baseUnit*3,textTransform:"uppercase"})},Lh=function(e){var n=ko(e);n.data;var i=je(n,Nh);return E("div",x({},z(e,"groupHeading",{"group-heading":!0}),i))},Dh=kh,Fh=["innerRef","isDisabled","isHidden","inputClassName"],Vh=function(e,n){var i=e.isDisabled,s=e.value,r=e.theme,o=r.spacing,l=r.colors;return I(I({visibility:i?"hidden":"visible",transform:s?"translateZ(0)":""},$h),n?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:l.neutral80})},Ho={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},$h={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":I({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Ho)},jh=function(e){return I({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},Ho)},Wh=function(e){var n=e.cx,i=e.value,s=ko(e),r=s.innerRef,o=s.isDisabled,l=s.isHidden,a=s.inputClassName,c=je(s,Fh);return E("div",x({},z(e,"input",{"input-container":!0}),{"data-value":i||""}),E("input",x({className:n({input:!0},a),ref:r,style:jh(l),disabled:o},c)))},Hh=Wh,Uh=function(e,n){var i=e.theme,s=i.spacing,r=i.borderRadius,o=i.colors;return I({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:o.neutral10,borderRadius:r/2,margin:s.baseUnit/2})},Bh=function(e,n){var i=e.theme,s=i.borderRadius,r=i.colors,o=e.cropWithEllipsis;return I({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:s/2,color:r.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},qh=function(e,n){var i=e.theme,s=i.spacing,r=i.borderRadius,o=i.colors,l=e.isFocused;return I({alignItems:"center",display:"flex"},n?{}:{borderRadius:r/2,backgroundColor:l?o.dangerLight:void 0,paddingLeft:s.baseUnit,paddingRight:s.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},Uo=function(e){var n=e.children,i=e.innerProps;return E("div",i,n)},zh=Uo,Gh=Uo;function Yh(t){var e=t.children,n=t.innerProps;return E("div",x({role:"button"},n),e||E(ts,{size:14}))}var Kh=function(e){var n=e.children,i=e.components,s=e.data,r=e.innerProps,o=e.isDisabled,l=e.removeProps,a=e.selectProps,c=i.Container,u=i.Label,d=i.Remove;return E(c,{data:s,innerProps:I(I({},z(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),r),selectProps:a},E(u,{data:s,innerProps:I({},z(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:a},n),E(d,{data:s,innerProps:I(I({},z(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},l),selectProps:a}))},Qh=Kh,Xh=function(e,n){var i=e.isDisabled,s=e.isFocused,r=e.isSelected,o=e.theme,l=o.spacing,a=o.colors;return I({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:r?a.primary:s?a.primary25:"transparent",color:i?a.neutral20:r?a.neutral0:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),":active":{backgroundColor:i?void 0:r?a.primary:a.primary50}})},Zh=function(e){var n=e.children,i=e.isDisabled,s=e.isFocused,r=e.isSelected,o=e.innerRef,l=e.innerProps;return E("div",x({},z(e,"option",{option:!0,"option--is-disabled":i,"option--is-focused":s,"option--is-selected":r}),{ref:o,"aria-disabled":i},l),n)},Jh=Zh,ef=function(e,n){var i=e.theme,s=i.spacing,r=i.colors;return I({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:r.neutral50,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},tf=function(e){var n=e.children,i=e.innerProps;return E("div",x({},z(e,"placeholder",{placeholder:!0}),i),n)},nf=tf,sf=function(e,n){var i=e.isDisabled,s=e.theme,r=s.spacing,o=s.colors;return I({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:i?o.neutral40:o.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2})},rf=function(e){var n=e.children,i=e.isDisabled,s=e.innerProps;return E("div",x({},z(e,"singleValue",{"single-value":!0,"single-value--is-disabled":i}),s),n)},of=rf,af={ClearIndicator:Sh,Control:Ph,DropdownIndicator:bh,DownChevron:jo,CrossIcon:ts,Group:Dh,GroupHeading:Lh,IndicatorsContainer:mh,IndicatorSeparator:Eh,Input:Hh,LoadingIndicator:Th,Menu:th,MenuList:ih,MenuPortal:ch,LoadingMessage:ah,NoOptionsMessage:oh,MultiValue:Qh,MultiValueContainer:zh,MultiValueLabel:Gh,MultiValueRemove:Yh,Option:Jh,Placeholder:nf,SelectContainer:dh,SingleValue:of,ValueContainer:fh},lf=function(e){return I(I({},af),e.components)},ir=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function cf(t,e){return!!(t===e||ir(t)&&ir(e))}function uf(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!cf(t[n],e[n]))return!1;return!0}function df(t,e){e===void 0&&(e=uf);var n=null;function i(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];if(n&&n.lastThis===this&&e(s,n.lastArgs))return n.lastResult;var o=t.apply(this,s);return n={lastResult:o,lastArgs:s,lastThis:this},o}return i.clear=function(){n=null},i}var hf={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},ff=function(e){return E("span",x({css:hf},e))},sr=ff,pf={guidance:function(e){var n=e.isSearchable,i=e.isMulti,s=e.tabSelectsValue,r=e.context,o=e.isInitialFocus;switch(r){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(s?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(e["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(i?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var n=e.action,i=e.label,s=i===void 0?"":i,r=e.labels,o=e.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(s,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(r.length>1?"s":""," ").concat(r.join(","),", selected.");case"select-option":return o?"option ".concat(s," is disabled. Select another option."):"option ".concat(s,", selected.");default:return""}},onFocus:function(e){var n=e.context,i=e.focused,s=e.options,r=e.label,o=r===void 0?"":r,l=e.selectValue,a=e.isDisabled,c=e.isSelected,u=e.isAppleDevice,d=function(m,g){return m&&m.length?"".concat(m.indexOf(g)+1," of ").concat(m.length):""};if(n==="value"&&l)return"value ".concat(o," focused, ").concat(d(l,i),".");if(n==="menu"&&u){var h=a?" disabled":"",f="".concat(c?" selected":"").concat(h);return"".concat(o).concat(f,", ").concat(d(s,i),".")}return""},onFilter:function(e){var n=e.inputValue,i=e.resultsMessage;return"".concat(i).concat(n?" for search term "+n:"",".")}},mf=function(e){var n=e.ariaSelection,i=e.focusedOption,s=e.focusedValue,r=e.focusableOptions,o=e.isFocused,l=e.selectValue,a=e.selectProps,c=e.id,u=e.isAppleDevice,d=a.ariaLiveMessages,h=a.getOptionLabel,f=a.inputValue,p=a.isMulti,m=a.isOptionDisabled,g=a.isSearchable,_=a.menuIsOpen,C=a.options,S=a.screenReaderStatus,T=a.tabSelectsValue,P=a.isLoading,O=a["aria-label"],w=a["aria-live"],N=y.useMemo(function(){return I(I({},pf),d||{})},[d]),q=y.useMemo(function(){var X="";if(n&&N.onChange){var Y=n.option,we=n.options,_e=n.removedValue,We=n.removedValues,He=n.value,Xt=function(Ne){return Array.isArray(Ne)?null:Ne},K=_e||Y||Xt(He),fe=K?h(K):"",Pe=we||We||void 0,Ue=Pe?Pe.map(h):[],ve=I({isDisabled:K&&m(K,l),label:fe,labels:Ue},n);X=N.onChange(ve)}return X},[n,N,m,l,h]),ie=y.useMemo(function(){var X="",Y=i||s,we=!!(i&&l&&l.includes(i));if(Y&&N.onFocus){var _e={focused:Y,label:h(Y),isDisabled:m(Y,l),isSelected:we,options:r,context:Y===i?"menu":"value",selectValue:l,isAppleDevice:u};X=N.onFocus(_e)}return X},[i,s,h,m,N,r,l,u]),le=y.useMemo(function(){var X="";if(_&&C.length&&!P&&N.onFilter){var Y=S({count:r.length});X=N.onFilter({inputValue:f,resultsMessage:Y})}return X},[r,f,_,N,C,S,P]),se=(n==null?void 0:n.action)==="initial-input-focus",Re=y.useMemo(function(){var X="";if(N.guidance){var Y=s?"value":_?"menu":"input";X=N.guidance({"aria-label":O,context:Y,isDisabled:i&&m(i,l),isMulti:p,isSearchable:g,tabSelectsValue:T,isInitialFocus:se})}return X},[O,i,s,p,m,g,_,N,l,T,se]),Oe=E(y.Fragment,null,E("span",{id:"aria-selection"},q),E("span",{id:"aria-focused"},ie),E("span",{id:"aria-results"},le),E("span",{id:"aria-guidance"},Re));return E(y.Fragment,null,E(sr,{id:c},se&&Oe),E(sr,{"aria-live":w,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!se&&Oe))},gf=mf,Ri=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],_f=new RegExp("["+Ri.map(function(t){return t.letters}).join("")+"]","g"),Bo={};for(var ci=0;ci<Ri.length;ci++)for(var ui=Ri[ci],di=0;di<ui.letters.length;di++)Bo[ui.letters[di]]=ui.base;var qo=function(e){return e.replace(_f,function(n){return Bo[n]})},vf=df(qo),rr=function(e){return e.replace(/^\s+|\s+$/g,"")},yf=function(e){return"".concat(e.label," ").concat(e.value)},bf=function(e){return function(n,i){if(n.data.__isNew__)return!0;var s=I({ignoreCase:!0,ignoreAccents:!0,stringify:yf,trim:!0,matchFrom:"any"},e),r=s.ignoreCase,o=s.ignoreAccents,l=s.stringify,a=s.trim,c=s.matchFrom,u=a?rr(i):i,d=a?rr(l(n)):l(n);return r&&(u=u.toLowerCase(),d=d.toLowerCase()),o&&(u=vf(u),d=qo(d)),c==="start"?d.substr(0,u.length)===u:d.indexOf(u)>-1}},Cf=["innerRef"];function Sf(t){var e=t.innerRef,n=je(t,Cf),i=Gd(n,"onExited","in","enter","exit","appear");return E("input",x({ref:e},i,{css:Xi({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var wf=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function Ef(t){var e=t.isEnabled,n=t.onBottomArrive,i=t.onBottomLeave,s=t.onTopArrive,r=t.onTopLeave,o=y.useRef(!1),l=y.useRef(!1),a=y.useRef(0),c=y.useRef(null),u=y.useCallback(function(g,_){if(c.current!==null){var C=c.current,S=C.scrollTop,T=C.scrollHeight,P=C.clientHeight,O=c.current,w=_>0,N=T-P-S,q=!1;N>_&&o.current&&(i&&i(g),o.current=!1),w&&l.current&&(r&&r(g),l.current=!1),w&&_>N?(n&&!o.current&&n(g),O.scrollTop=T,q=!0,o.current=!0):!w&&-_>S&&(s&&!l.current&&s(g),O.scrollTop=0,q=!0,l.current=!0),q&&wf(g)}},[n,i,s,r]),d=y.useCallback(function(g){u(g,g.deltaY)},[u]),h=y.useCallback(function(g){a.current=g.changedTouches[0].clientY},[]),f=y.useCallback(function(g){var _=a.current-g.changedTouches[0].clientY;u(g,_)},[u]),p=y.useCallback(function(g){if(g){var _=Bd?{passive:!1}:!1;g.addEventListener("wheel",d,_),g.addEventListener("touchstart",h,_),g.addEventListener("touchmove",f,_)}},[f,h,d]),m=y.useCallback(function(g){g&&(g.removeEventListener("wheel",d,!1),g.removeEventListener("touchstart",h,!1),g.removeEventListener("touchmove",f,!1))},[f,h,d]);return y.useEffect(function(){if(e){var g=c.current;return p(g),function(){m(g)}}},[e,p,m]),function(g){c.current=g}}var or=["boxSizing","height","overflow","paddingRight","position"],ar={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function lr(t){t.preventDefault()}function cr(t){t.stopPropagation()}function ur(){var t=this.scrollTop,e=this.scrollHeight,n=t+this.offsetHeight;t===0?this.scrollTop=1:n===e&&(this.scrollTop=t-1)}function dr(){return"ontouchstart"in window||navigator.maxTouchPoints}var hr=!!(typeof window<"u"&&window.document&&window.document.createElement),St=0,ot={capture:!1,passive:!1};function If(t){var e=t.isEnabled,n=t.accountForScrollbars,i=n===void 0?!0:n,s=y.useRef({}),r=y.useRef(null),o=y.useCallback(function(a){if(hr){var c=document.body,u=c&&c.style;if(i&&or.forEach(function(p){var m=u&&u[p];s.current[p]=m}),i&&St<1){var d=parseInt(s.current.paddingRight,10)||0,h=document.body?document.body.clientWidth:0,f=window.innerWidth-h+d||0;Object.keys(ar).forEach(function(p){var m=ar[p];u&&(u[p]=m)}),u&&(u.paddingRight="".concat(f,"px"))}c&&dr()&&(c.addEventListener("touchmove",lr,ot),a&&(a.addEventListener("touchstart",ur,ot),a.addEventListener("touchmove",cr,ot))),St+=1}},[i]),l=y.useCallback(function(a){if(hr){var c=document.body,u=c&&c.style;St=Math.max(St-1,0),i&&St<1&&or.forEach(function(d){var h=s.current[d];u&&(u[d]=h)}),c&&dr()&&(c.removeEventListener("touchmove",lr,ot),a&&(a.removeEventListener("touchstart",ur,ot),a.removeEventListener("touchmove",cr,ot)))}},[i]);return y.useEffect(function(){if(e){var a=r.current;return o(a),function(){l(a)}}},[e,o,l]),function(a){r.current=a}}var xf=function(e){var n=e.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},Tf={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function Rf(t){var e=t.children,n=t.lockEnabled,i=t.captureEnabled,s=i===void 0?!0:i,r=t.onBottomArrive,o=t.onBottomLeave,l=t.onTopArrive,a=t.onTopLeave,c=Ef({isEnabled:s,onBottomArrive:r,onBottomLeave:o,onTopArrive:l,onTopLeave:a}),u=If({isEnabled:n}),d=function(f){c(f),u(f)};return E(y.Fragment,null,n&&E("div",{onClick:xf,css:Tf}),e(d))}var Of={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},Pf=function(e){var n=e.name,i=e.onFocus;return E("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:i,css:Of,value:"",onChange:function(){}})},Nf=Pf;function ns(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Mf(){return ns(/^iPhone/i)}function zo(){return ns(/^Mac/i)}function kf(){return ns(/^iPad/i)||zo()&&navigator.maxTouchPoints>1}function Af(){return Mf()||kf()}function Lf(){return zo()||Af()}var Df=function(e){return e.label},Ff=function(e){return e.label},Vf=function(e){return e.value},$f=function(e){return!!e.isDisabled},jf={clearIndicator:Ch,container:uh,control:Rh,dropdownIndicator:yh,group:Mh,groupHeading:Ah,indicatorsContainer:ph,indicatorSeparator:wh,input:Vh,loadingIndicator:xh,loadingMessage:rh,menu:Zd,menuList:nh,menuPortal:lh,multiValue:Uh,multiValueLabel:Bh,multiValueRemove:qh,noOptionsMessage:sh,option:Xh,placeholder:ef,singleValue:sf,valueContainer:hh},Wf={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},Hf=4,Go=4,Uf=38,Bf=Go*2,qf={baseUnit:Go,controlHeight:Uf,menuGutter:Bf},hi={borderRadius:Hf,colors:Wf,spacing:qf},zf={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:tr(),captureMenuScroll:!tr(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:bf(),formatGroupLabel:Df,getOptionLabel:Ff,getOptionValue:Vf,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:$f,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Hd(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var n=e.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function fr(t,e,n,i){var s=Qo(t,e,n),r=Xo(t,e,n),o=Ko(t,e),l=Sn(t,e);return{type:"option",data:e,isDisabled:s,isSelected:r,label:o,value:l,index:i}}function hn(t,e){return t.options.map(function(n,i){if("options"in n){var s=n.options.map(function(o,l){return fr(t,o,e,l)}).filter(function(o){return mr(t,o)});return s.length>0?{type:"group",data:n,options:s,index:i}:void 0}var r=fr(t,n,e,i);return mr(t,r)?r:void 0}).filter(qd)}function Yo(t){return t.reduce(function(e,n){return n.type==="group"?e.push.apply(e,Ui(n.options.map(function(i){return i.data}))):e.push(n.data),e},[])}function pr(t,e){return t.reduce(function(n,i){return i.type==="group"?n.push.apply(n,Ui(i.options.map(function(s){return{data:s.data,id:"".concat(e,"-").concat(i.index,"-").concat(s.index)}}))):n.push({data:i.data,id:"".concat(e,"-").concat(i.index)}),n},[])}function Gf(t,e){return Yo(hn(t,e))}function mr(t,e){var n=t.inputValue,i=n===void 0?"":n,s=e.data,r=e.isSelected,o=e.label,l=e.value;return(!Jo(t)||!r)&&Zo(t,{label:o,value:l,data:s},i)}function Yf(t,e){var n=t.focusedValue,i=t.selectValue,s=i.indexOf(n);if(s>-1){var r=e.indexOf(n);if(r>-1)return n;if(s<e.length)return e[s]}return null}function Kf(t,e){var n=t.focusedOption;return n&&e.indexOf(n)>-1?n:e[0]}var fi=function(e,n){var i,s=(i=e.find(function(r){return r.data===n}))===null||i===void 0?void 0:i.id;return s||null},Ko=function(e,n){return e.getOptionLabel(n)},Sn=function(e,n){return e.getOptionValue(n)};function Qo(t,e,n){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(e,n):!1}function Xo(t,e,n){if(n.indexOf(e)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(e,n);var i=Sn(t,e);return n.some(function(s){return Sn(t,s)===i})}function Zo(t,e,n){return t.filterOption?t.filterOption(e,n):!0}var Jo=function(e){var n=e.hideSelectedOptions,i=e.isMulti;return n===void 0?i:n},Qf=1,ea=function(t){pu(n,t);var e=_u(n);function n(i){var s;if(hu(this,n),s=e.call(this,i),s.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},s.blockOptionHover=!1,s.isComposing=!1,s.commonProps=void 0,s.initialTouchX=0,s.initialTouchY=0,s.openAfterFocus=!1,s.scrollToFocusedOptionOnUpdate=!1,s.userIsDragging=void 0,s.isAppleDevice=Lf(),s.controlRef=null,s.getControlRef=function(a){s.controlRef=a},s.focusedOptionRef=null,s.getFocusedOptionRef=function(a){s.focusedOptionRef=a},s.menuListRef=null,s.getMenuListRef=function(a){s.menuListRef=a},s.inputRef=null,s.getInputRef=function(a){s.inputRef=a},s.focus=s.focusInput,s.blur=s.blurInput,s.onChange=function(a,c){var u=s.props,d=u.onChange,h=u.name;c.name=h,s.ariaOnChange(a,c),d(a,c)},s.setValue=function(a,c,u){var d=s.props,h=d.closeMenuOnSelect,f=d.isMulti,p=d.inputValue;s.onInputChange("",{action:"set-value",prevInputValue:p}),h&&(s.setState({inputIsHiddenAfterUpdate:!f}),s.onMenuClose()),s.setState({clearFocusValueOnUpdate:!0}),s.onChange(a,{action:c,option:u})},s.selectOption=function(a){var c=s.props,u=c.blurInputOnSelect,d=c.isMulti,h=c.name,f=s.state.selectValue,p=d&&s.isOptionSelected(a,f),m=s.isOptionDisabled(a,f);if(p){var g=s.getOptionValue(a);s.setValue(f.filter(function(_){return s.getOptionValue(_)!==g}),"deselect-option",a)}else if(!m)d?s.setValue([].concat(Ui(f),[a]),"select-option",a):s.setValue(a,"select-option");else{s.ariaOnChange(a,{action:"select-option",option:a,name:h});return}u&&s.blurInput()},s.removeValue=function(a){var c=s.props.isMulti,u=s.state.selectValue,d=s.getOptionValue(a),h=u.filter(function(p){return s.getOptionValue(p)!==d}),f=on(c,h,h[0]||null);s.onChange(f,{action:"remove-value",removedValue:a}),s.focusInput()},s.clearValue=function(){var a=s.state.selectValue;s.onChange(on(s.props.isMulti,[],null),{action:"clear",removedValues:a})},s.popValue=function(){var a=s.props.isMulti,c=s.state.selectValue,u=c[c.length-1],d=c.slice(0,c.length-1),h=on(a,d,d[0]||null);s.onChange(h,{action:"pop-value",removedValue:u})},s.getFocusedOptionId=function(a){return fi(s.state.focusableOptionsWithIds,a)},s.getFocusableOptionsWithIds=function(){return pr(hn(s.props,s.state.selectValue),s.getElementId("option"))},s.getValue=function(){return s.state.selectValue},s.cx=function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return Fd.apply(void 0,[s.props.classNamePrefix].concat(c))},s.getOptionLabel=function(a){return Ko(s.props,a)},s.getOptionValue=function(a){return Sn(s.props,a)},s.getStyles=function(a,c){var u=s.props.unstyled,d=jf[a](c,u);d.boxSizing="border-box";var h=s.props.styles[a];return h?h(d,c):d},s.getClassNames=function(a,c){var u,d;return(u=(d=s.props.classNames)[a])===null||u===void 0?void 0:u.call(d,c)},s.getElementId=function(a){return"".concat(s.state.instancePrefix,"-").concat(a)},s.getComponents=function(){return lf(s.props)},s.buildCategorizedOptions=function(){return hn(s.props,s.state.selectValue)},s.getCategorizedOptions=function(){return s.props.menuIsOpen?s.buildCategorizedOptions():[]},s.buildFocusableOptions=function(){return Yo(s.buildCategorizedOptions())},s.getFocusableOptions=function(){return s.props.menuIsOpen?s.buildFocusableOptions():[]},s.ariaOnChange=function(a,c){s.setState({ariaSelection:I({value:a},c)})},s.onMenuMouseDown=function(a){a.button===0&&(a.stopPropagation(),a.preventDefault(),s.focusInput())},s.onMenuMouseMove=function(a){s.blockOptionHover=!1},s.onControlMouseDown=function(a){if(!a.defaultPrevented){var c=s.props.openMenuOnClick;s.state.isFocused?s.props.menuIsOpen?a.target.tagName!=="INPUT"&&a.target.tagName!=="TEXTAREA"&&s.onMenuClose():c&&s.openMenu("first"):(c&&(s.openAfterFocus=!0),s.focusInput()),a.target.tagName!=="INPUT"&&a.target.tagName!=="TEXTAREA"&&a.preventDefault()}},s.onDropdownIndicatorMouseDown=function(a){if(!(a&&a.type==="mousedown"&&a.button!==0)&&!s.props.isDisabled){var c=s.props,u=c.isMulti,d=c.menuIsOpen;s.focusInput(),d?(s.setState({inputIsHiddenAfterUpdate:!u}),s.onMenuClose()):s.openMenu("first"),a.preventDefault()}},s.onClearIndicatorMouseDown=function(a){a&&a.type==="mousedown"&&a.button!==0||(s.clearValue(),a.preventDefault(),s.openAfterFocus=!1,a.type==="touchend"?s.focusInput():setTimeout(function(){return s.focusInput()}))},s.onScroll=function(a){typeof s.props.closeMenuOnScroll=="boolean"?a.target instanceof HTMLElement&&Qn(a.target)&&s.props.onMenuClose():typeof s.props.closeMenuOnScroll=="function"&&s.props.closeMenuOnScroll(a)&&s.props.onMenuClose()},s.onCompositionStart=function(){s.isComposing=!0},s.onCompositionEnd=function(){s.isComposing=!1},s.onTouchStart=function(a){var c=a.touches,u=c&&c.item(0);u&&(s.initialTouchX=u.clientX,s.initialTouchY=u.clientY,s.userIsDragging=!1)},s.onTouchMove=function(a){var c=a.touches,u=c&&c.item(0);if(u){var d=Math.abs(u.clientX-s.initialTouchX),h=Math.abs(u.clientY-s.initialTouchY),f=5;s.userIsDragging=d>f||h>f}},s.onTouchEnd=function(a){s.userIsDragging||(s.controlRef&&!s.controlRef.contains(a.target)&&s.menuListRef&&!s.menuListRef.contains(a.target)&&s.blurInput(),s.initialTouchX=0,s.initialTouchY=0)},s.onControlTouchEnd=function(a){s.userIsDragging||s.onControlMouseDown(a)},s.onClearIndicatorTouchEnd=function(a){s.userIsDragging||s.onClearIndicatorMouseDown(a)},s.onDropdownIndicatorTouchEnd=function(a){s.userIsDragging||s.onDropdownIndicatorMouseDown(a)},s.handleInputChange=function(a){var c=s.props.inputValue,u=a.currentTarget.value;s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange(u,{action:"input-change",prevInputValue:c}),s.props.menuIsOpen||s.onMenuOpen()},s.onInputFocus=function(a){s.props.onFocus&&s.props.onFocus(a),s.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(s.openAfterFocus||s.props.openMenuOnFocus)&&s.openMenu("first"),s.openAfterFocus=!1},s.onInputBlur=function(a){var c=s.props.inputValue;if(s.menuListRef&&s.menuListRef.contains(document.activeElement)){s.inputRef.focus();return}s.props.onBlur&&s.props.onBlur(a),s.onInputChange("",{action:"input-blur",prevInputValue:c}),s.onMenuClose(),s.setState({focusedValue:null,isFocused:!1})},s.onOptionHover=function(a){if(!(s.blockOptionHover||s.state.focusedOption===a)){var c=s.getFocusableOptions(),u=c.indexOf(a);s.setState({focusedOption:a,focusedOptionId:u>-1?s.getFocusedOptionId(a):null})}},s.shouldHideSelectedOptions=function(){return Jo(s.props)},s.onValueInputFocus=function(a){a.preventDefault(),a.stopPropagation(),s.focus()},s.onKeyDown=function(a){var c=s.props,u=c.isMulti,d=c.backspaceRemovesValue,h=c.escapeClearsValue,f=c.inputValue,p=c.isClearable,m=c.isDisabled,g=c.menuIsOpen,_=c.onKeyDown,C=c.tabSelectsValue,S=c.openMenuOnFocus,T=s.state,P=T.focusedOption,O=T.focusedValue,w=T.selectValue;if(!m&&!(typeof _=="function"&&(_(a),a.defaultPrevented))){switch(s.blockOptionHover=!0,a.key){case"ArrowLeft":if(!u||f)return;s.focusValue("previous");break;case"ArrowRight":if(!u||f)return;s.focusValue("next");break;case"Delete":case"Backspace":if(f)return;if(O)s.removeValue(O);else{if(!d)return;u?s.popValue():p&&s.clearValue()}break;case"Tab":if(s.isComposing||a.shiftKey||!g||!C||!P||S&&s.isOptionSelected(P,w))return;s.selectOption(P);break;case"Enter":if(a.keyCode===229)break;if(g){if(!P||s.isComposing)return;s.selectOption(P);break}return;case"Escape":g?(s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange("",{action:"menu-close",prevInputValue:f}),s.onMenuClose()):p&&h&&s.clearValue();break;case" ":if(f)return;if(!g){s.openMenu("first");break}if(!P)return;s.selectOption(P);break;case"ArrowUp":g?s.focusOption("up"):s.openMenu("last");break;case"ArrowDown":g?s.focusOption("down"):s.openMenu("first");break;case"PageUp":if(!g)return;s.focusOption("pageup");break;case"PageDown":if(!g)return;s.focusOption("pagedown");break;case"Home":if(!g)return;s.focusOption("first");break;case"End":if(!g)return;s.focusOption("last");break;default:return}a.preventDefault()}},s.state.instancePrefix="react-select-"+(s.props.instanceId||++Qf),s.state.selectValue=Js(i.value),i.menuIsOpen&&s.state.selectValue.length){var r=s.getFocusableOptionsWithIds(),o=s.buildFocusableOptions(),l=o.indexOf(s.state.selectValue[0]);s.state.focusableOptionsWithIds=r,s.state.focusedOption=o[l],s.state.focusedOptionId=fi(r,o[l])}return s}return fu(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&er(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(s){var r=this.props,o=r.isDisabled,l=r.menuIsOpen,a=this.state.isFocused;(a&&!o&&s.isDisabled||a&&l&&!s.menuIsOpen)&&this.focusInput(),a&&o&&!s.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!a&&!o&&s.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(er(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(s,r){this.props.onInputChange(s,r)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(s){var r=this,o=this.state,l=o.selectValue,a=o.isFocused,c=this.buildFocusableOptions(),u=s==="first"?0:c.length-1;if(!this.props.isMulti){var d=c.indexOf(l[0]);d>-1&&(u=d)}this.scrollToFocusedOptionOnUpdate=!(a&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:c[u],focusedOptionId:this.getFocusedOptionId(c[u])},function(){return r.onMenuOpen()})}},{key:"focusValue",value:function(s){var r=this.state,o=r.selectValue,l=r.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var a=o.indexOf(l);l||(a=-1);var c=o.length-1,u=-1;if(o.length){switch(s){case"previous":a===0?u=0:a===-1?u=c:u=a-1;break;case"next":a>-1&&a<c&&(u=a+1);break}this.setState({inputIsHidden:u!==-1,focusedValue:o[u]})}}}},{key:"focusOption",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",r=this.props.pageSize,o=this.state.focusedOption,l=this.getFocusableOptions();if(l.length){var a=0,c=l.indexOf(o);o||(c=-1),s==="up"?a=c>0?c-1:l.length-1:s==="down"?a=(c+1)%l.length:s==="pageup"?(a=c-r,a<0&&(a=0)):s==="pagedown"?(a=c+r,a>l.length-1&&(a=l.length-1)):s==="last"&&(a=l.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:l[a],focusedValue:null,focusedOptionId:this.getFocusedOptionId(l[a])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(hi):I(I({},hi),this.props.theme):hi}},{key:"getCommonProps",value:function(){var s=this.clearValue,r=this.cx,o=this.getStyles,l=this.getClassNames,a=this.getValue,c=this.selectOption,u=this.setValue,d=this.props,h=d.isMulti,f=d.isRtl,p=d.options,m=this.hasValue();return{clearValue:s,cx:r,getStyles:o,getClassNames:l,getValue:a,hasValue:m,isMulti:h,isRtl:f,options:p,selectOption:c,selectProps:d,setValue:u,theme:this.getTheme()}}},{key:"hasValue",value:function(){var s=this.state.selectValue;return s.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var s=this.props,r=s.isClearable,o=s.isMulti;return r===void 0?o:r}},{key:"isOptionDisabled",value:function(s,r){return Qo(this.props,s,r)}},{key:"isOptionSelected",value:function(s,r){return Xo(this.props,s,r)}},{key:"filterOption",value:function(s,r){return Zo(this.props,s,r)}},{key:"formatOptionLabel",value:function(s,r){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,l=this.state.selectValue;return this.props.formatOptionLabel(s,{context:r,inputValue:o,selectValue:l})}else return this.getOptionLabel(s)}},{key:"formatGroupLabel",value:function(s){return this.props.formatGroupLabel(s)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var s=this.props,r=s.isDisabled,o=s.isSearchable,l=s.inputId,a=s.inputValue,c=s.tabIndex,u=s.form,d=s.menuIsOpen,h=s.required,f=this.getComponents(),p=f.Input,m=this.state,g=m.inputIsHidden,_=m.ariaSelection,C=this.commonProps,S=l||this.getElementId("input"),T=I(I(I({"aria-autocomplete":"list","aria-expanded":d,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":h,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},d&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(_==null?void 0:_.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?y.createElement(p,x({},C,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:S,innerRef:this.getInputRef,isDisabled:r,isHidden:g,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:c,form:u,type:"text",value:a},T)):y.createElement(Sf,x({id:S,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:bn,onFocus:this.onInputFocus,disabled:r,tabIndex:c,inputMode:"none",form:u,value:""},T))}},{key:"renderPlaceholderOrValue",value:function(){var s=this,r=this.getComponents(),o=r.MultiValue,l=r.MultiValueContainer,a=r.MultiValueLabel,c=r.MultiValueRemove,u=r.SingleValue,d=r.Placeholder,h=this.commonProps,f=this.props,p=f.controlShouldRenderValue,m=f.isDisabled,g=f.isMulti,_=f.inputValue,C=f.placeholder,S=this.state,T=S.selectValue,P=S.focusedValue,O=S.isFocused;if(!this.hasValue()||!p)return _?null:y.createElement(d,x({},h,{key:"placeholder",isDisabled:m,isFocused:O,innerProps:{id:this.getElementId("placeholder")}}),C);if(g)return T.map(function(N,q){var ie=N===P,le="".concat(s.getOptionLabel(N),"-").concat(s.getOptionValue(N));return y.createElement(o,x({},h,{components:{Container:l,Label:a,Remove:c},isFocused:ie,isDisabled:m,key:le,index:q,removeProps:{onClick:function(){return s.removeValue(N)},onTouchEnd:function(){return s.removeValue(N)},onMouseDown:function(Re){Re.preventDefault()}},data:N}),s.formatOptionLabel(N,"value"))});if(_)return null;var w=T[0];return y.createElement(u,x({},h,{data:w,isDisabled:m}),this.formatOptionLabel(w,"value"))}},{key:"renderClearIndicator",value:function(){var s=this.getComponents(),r=s.ClearIndicator,o=this.commonProps,l=this.props,a=l.isDisabled,c=l.isLoading,u=this.state.isFocused;if(!this.isClearable()||!r||a||!this.hasValue()||c)return null;var d={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return y.createElement(r,x({},o,{innerProps:d,isFocused:u}))}},{key:"renderLoadingIndicator",value:function(){var s=this.getComponents(),r=s.LoadingIndicator,o=this.commonProps,l=this.props,a=l.isDisabled,c=l.isLoading,u=this.state.isFocused;if(!r||!c)return null;var d={"aria-hidden":"true"};return y.createElement(r,x({},o,{innerProps:d,isDisabled:a,isFocused:u}))}},{key:"renderIndicatorSeparator",value:function(){var s=this.getComponents(),r=s.DropdownIndicator,o=s.IndicatorSeparator;if(!r||!o)return null;var l=this.commonProps,a=this.props.isDisabled,c=this.state.isFocused;return y.createElement(o,x({},l,{isDisabled:a,isFocused:c}))}},{key:"renderDropdownIndicator",value:function(){var s=this.getComponents(),r=s.DropdownIndicator;if(!r)return null;var o=this.commonProps,l=this.props.isDisabled,a=this.state.isFocused,c={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return y.createElement(r,x({},o,{innerProps:c,isDisabled:l,isFocused:a}))}},{key:"renderMenu",value:function(){var s=this,r=this.getComponents(),o=r.Group,l=r.GroupHeading,a=r.Menu,c=r.MenuList,u=r.MenuPortal,d=r.LoadingMessage,h=r.NoOptionsMessage,f=r.Option,p=this.commonProps,m=this.state.focusedOption,g=this.props,_=g.captureMenuScroll,C=g.inputValue,S=g.isLoading,T=g.loadingMessage,P=g.minMenuHeight,O=g.maxMenuHeight,w=g.menuIsOpen,N=g.menuPlacement,q=g.menuPosition,ie=g.menuPortalTarget,le=g.menuShouldBlockScroll,se=g.menuShouldScrollIntoView,Re=g.noOptionsMessage,Oe=g.onMenuScrollToTop,X=g.onMenuScrollToBottom;if(!w)return null;var Y=function(fe,Pe){var Ue=fe.type,ve=fe.data,Be=fe.isDisabled,Ne=fe.isSelected,Zt=fe.label,_l=fe.value,Ls=m===ve,Ds=Be?void 0:function(){return s.onOptionHover(ve)},vl=Be?void 0:function(){return s.selectOption(ve)},Fs="".concat(s.getElementId("option"),"-").concat(Pe),yl={id:Fs,onClick:vl,onMouseMove:Ds,onMouseOver:Ds,tabIndex:-1,role:"option","aria-selected":s.isAppleDevice?void 0:Ne};return y.createElement(f,x({},p,{innerProps:yl,data:ve,isDisabled:Be,isSelected:Ne,key:Fs,label:Zt,type:Ue,value:_l,isFocused:Ls,innerRef:Ls?s.getFocusedOptionRef:void 0}),s.formatOptionLabel(fe.data,"menu"))},we;if(this.hasOptions())we=this.getCategorizedOptions().map(function(K){if(K.type==="group"){var fe=K.data,Pe=K.options,Ue=K.index,ve="".concat(s.getElementId("group"),"-").concat(Ue),Be="".concat(ve,"-heading");return y.createElement(o,x({},p,{key:ve,data:fe,options:Pe,Heading:l,headingProps:{id:Be,data:K.data},label:s.formatGroupLabel(K.data)}),K.options.map(function(Ne){return Y(Ne,"".concat(Ue,"-").concat(Ne.index))}))}else if(K.type==="option")return Y(K,"".concat(K.index))});else if(S){var _e=T({inputValue:C});if(_e===null)return null;we=y.createElement(d,p,_e)}else{var We=Re({inputValue:C});if(We===null)return null;we=y.createElement(h,p,We)}var He={minMenuHeight:P,maxMenuHeight:O,menuPlacement:N,menuPosition:q,menuShouldScrollIntoView:se},Xt=y.createElement(Jd,x({},p,He),function(K){var fe=K.ref,Pe=K.placerProps,Ue=Pe.placement,ve=Pe.maxHeight;return y.createElement(a,x({},p,He,{innerRef:fe,innerProps:{onMouseDown:s.onMenuMouseDown,onMouseMove:s.onMenuMouseMove},isLoading:S,placement:Ue}),y.createElement(Rf,{captureEnabled:_,onTopArrive:Oe,onBottomArrive:X,lockEnabled:le},function(Be){return y.createElement(c,x({},p,{innerRef:function(Zt){s.getMenuListRef(Zt),Be(Zt)},innerProps:{role:"listbox","aria-multiselectable":p.isMulti,id:s.getElementId("listbox")},isLoading:S,maxHeight:ve,focusedOption:m}),we)}))});return ie||q==="fixed"?y.createElement(u,x({},p,{appendTo:ie,controlElement:this.controlRef,menuPlacement:N,menuPosition:q}),Xt):Xt}},{key:"renderFormField",value:function(){var s=this,r=this.props,o=r.delimiter,l=r.isDisabled,a=r.isMulti,c=r.name,u=r.required,d=this.state.selectValue;if(u&&!this.hasValue()&&!l)return y.createElement(Nf,{name:c,onFocus:this.onValueInputFocus});if(!(!c||l))if(a)if(o){var h=d.map(function(m){return s.getOptionValue(m)}).join(o);return y.createElement("input",{name:c,type:"hidden",value:h})}else{var f=d.length>0?d.map(function(m,g){return y.createElement("input",{key:"i-".concat(g),name:c,type:"hidden",value:s.getOptionValue(m)})}):y.createElement("input",{name:c,type:"hidden",value:""});return y.createElement("div",null,f)}else{var p=d[0]?this.getOptionValue(d[0]):"";return y.createElement("input",{name:c,type:"hidden",value:p})}}},{key:"renderLiveRegion",value:function(){var s=this.commonProps,r=this.state,o=r.ariaSelection,l=r.focusedOption,a=r.focusedValue,c=r.isFocused,u=r.selectValue,d=this.getFocusableOptions();return y.createElement(gf,x({},s,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:l,focusedValue:a,isFocused:c,selectValue:u,focusableOptions:d,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var s=this.getComponents(),r=s.Control,o=s.IndicatorsContainer,l=s.SelectContainer,a=s.ValueContainer,c=this.props,u=c.className,d=c.id,h=c.isDisabled,f=c.menuIsOpen,p=this.state.isFocused,m=this.commonProps=this.getCommonProps();return y.createElement(l,x({},m,{className:u,innerProps:{id:d,onKeyDown:this.onKeyDown},isDisabled:h,isFocused:p}),this.renderLiveRegion(),y.createElement(r,x({},m,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:h,isFocused:p,menuIsOpen:f}),y.createElement(a,x({},m,{isDisabled:h}),this.renderPlaceholderOrValue(),this.renderInput()),y.createElement(o,x({},m,{isDisabled:h}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(s,r){var o=r.prevProps,l=r.clearFocusValueOnUpdate,a=r.inputIsHiddenAfterUpdate,c=r.ariaSelection,u=r.isFocused,d=r.prevWasFocused,h=r.instancePrefix,f=s.options,p=s.value,m=s.menuIsOpen,g=s.inputValue,_=s.isMulti,C=Js(p),S={};if(o&&(p!==o.value||f!==o.options||m!==o.menuIsOpen||g!==o.inputValue)){var T=m?Gf(s,C):[],P=m?pr(hn(s,C),"".concat(h,"-option")):[],O=l?Yf(r,C):null,w=Kf(r,T),N=fi(P,w);S={selectValue:C,focusedOption:w,focusedOptionId:N,focusableOptionsWithIds:P,focusedValue:O,clearFocusValueOnUpdate:!1}}var q=a!=null&&s!==o?{inputIsHidden:a,inputIsHiddenAfterUpdate:void 0}:{},ie=c,le=u&&d;return u&&!le&&(ie={value:on(_,C,C[0]||null),options:C,action:"initial-input-focus"},le=!d),(c==null?void 0:c.action)==="initial-input-focus"&&(ie=null),I(I(I({},S),q),{},{prevProps:s,ariaSelection:ie,prevWasFocused:le})}}]),n}(y.Component);ea.defaultProps=zf;var Xf=y.forwardRef(function(t,e){var n=du(t);return y.createElement(ea,x({ref:e},n))}),Zf=Xf;const Jf="_wrap_97yey_1",ep="_label_97yey_21",tp="_select_97yey_31",pi={wrap:Jf,label:ep,select:tp},np=[{value:"name",label:"A to Z"},{value:"name desc",label:"Z to A"},{value:"price_per_hour",label:"Price from the lowest"},{value:"price_per_hour desc",label:"Price from the highest"},{value:"rating",label:"Popular from the lowest"},{value:"rating desc",label:"Popular from the highest"},{value:"all",label:"Show all"}],y_=({selectedOption:t,setSelectedOption:e})=>v.jsx("div",{className:pi.wrap,children:v.jsxs("label",{className:pi.label,children:["Filters",v.jsx(Zf,{className:pi.select,defaultValue:t,onChange:e,options:np,components:{IndicatorSeparator:()=>null},"aria-label":"Filters",placeholder:"A to Z",styles:{control:(n,i)=>({...n,borderRadius:"14px",boxShadow:(i.isFocused,"var(--green)"),width:"226px",height:"48px",cursor:"pointer",backgroundColor:"var(--green)",borderColor:"var(--light-green)",":hover":{borderColor:"var(--green)"},caretColor:"transparent"}),singleValue:n=>({...n,color:"var(--white)"}),dropdownIndicator:(n,i)=>({...n,color:(i.isFocused,"var(--white)"),transform:i.isFocused?"rotate(0deg)":"rotate(180deg)",":hover":{color:"var(--white)",transform:"rotate(0deg)"},":active":{transform:"rotate(0deg)"}}),option:(n,i)=>({...n,color:i.isSelected?"var(--black)":"rgba(25, 26, 21, 0.3)",backgroundColor:i.isFocused?"rgba(84, 190, 150, 0.2)":"var(--white)",boxShadow:i.isFocused?"rgba(84, 190, 150, 0.2)":"var(--white)",cursor:"pointer",":active":{backgroundColor:(i.isSelected,"rgba(84, 190, 150, 0.2)")}}),menu:n=>({...n,borderRadius:"14px",":active":{dropdownIndicator:i=>({...i,transform:"rotate(180deg)"})}}),placeholder:n=>({...n,color:"var(--white)"}),menuList:n=>({...n,borderRadius:"14px",color:"var(--white)",":active":{dropdownIndicator:i=>({...i,transform:"rotate(180deg)"})}})}})]})});var gr={};const _r="@firebase/database",vr="1.0.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ta="";function ip(t){ta=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ee(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Wi(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Te(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new sp(e)}}catch{}return new rp},Xe=na("localStorage"),op=na("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt=new Nl("@firebase/database"),ap=function(){let t=1;return function(){return t++}}(),ia=function(t){const e=Vl(t),n=new $l;n.update(e);const i=n.digest();return jl.encodeByteArray(i)},qt=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=qt.apply(null,i):typeof i=="object"?e+=ee(i):e+=i,e+=" "}return e};let Rt=null,yr=!0;const lp=function(t,e){b(!e,"Can't turn on custom loggers persistently."),dt.logLevel=Wl.VERBOSE,Rt=dt.log.bind(dt)},oe=function(...t){if(yr===!0&&(yr=!1,Rt===null&&op.get("logging_enabled")===!0&&lp()),Rt){const e=qt.apply(null,t);Rt(e)}},zt=function(t){return function(...e){oe(t,...e)}},Oi=function(...t){const e="FIREBASE INTERNAL ERROR: "+qt(...t);dt.error(e)},Ve=function(...t){const e=`FIREBASE FATAL ERROR: ${qt(...t)}`;throw dt.error(e),new Error(e)},me=function(...t){const e="FIREBASE WARNING: "+qt(...t);dt.warn(e)},cp=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&me("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},is=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},up=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Je="[MIN_NAME]",$e="[MAX_NAME]",vt=function(t,e){if(t===e)return 0;if(t===Je||e===$e)return-1;if(e===Je||t===$e)return 1;{const n=br(t),i=br(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},dp=function(t,e){return t===e?0:t<e?-1:1},wt=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ee(e))},ss=function(t){if(typeof t!="object"||t===null)return ee(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=ee(e[i]),n+=":",n+=ss(t[e[i]]);return n+="}",n},sa=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function he(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ra=function(t){b(!is(t),"Invalid JSON number");const e=11,n=52,i=(1<<e-1)-1;let s,r,o,l,a;t===0?(r=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),i),r=l+i,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-i-n))));const c=[];for(a=n;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(a=0;a<64;a+=8){let h=parseInt(u.substr(a,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},hp=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},fp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function pp(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}const mp=new RegExp("^-?(0*)\\d{1,10}$"),gp=-2147483648,_p=2147483647,br=function(t){if(mp.test(t)){const e=Number(t);if(e>=gp&&e<=_p)return e}return null},Gt=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw me("Exception was thrown by user callback.",n),e},Math.floor(0))}},vp=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ot=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){me(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(oe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',me(e)}}class fn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}fn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="5",oa="v",aa="s",la="r",ca="f",ua=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,da="ls",ha="p",Pi="ac",fa="websocket",pa="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,n,i,s,r=!1,o="",l=!1,a=!1){this.secure=n,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Xe.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Xe.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Cp(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function ga(t,e,n){b(typeof e=="string","typeof type must == string"),b(typeof n=="object","typeof params must == object");let i;if(e===fa)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===pa)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Cp(t)&&(n.ns=t.namespace);const s=[];return he(n,(r,o)=>{s.push(r+"="+o)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(){this.counters_={}}incrementCounter(e,n=1){Te(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return zl(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi={},gi={};function os(t){const e=t.toString();return mi[e]||(mi[e]=new Sp),mi[e]}function wp(t,e){const n=t.toString();return gi[n]||(gi[n]=e()),gi[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Gt(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="start",Ip="close",xp="pLPCommand",Tp="pRTLPCB",_a="id",va="pw",ya="ser",Rp="cb",Op="seg",Pp="ts",Np="d",Mp="dframe",ba=1870,Ca=30,kp=ba-Ca,Ap=25e3,Lp=3e4;class lt{constructor(e,n,i,s,r,o,l){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=s,this.authToken=r,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=zt(e),this.stats_=os(n),this.urlFn=a=>(this.appCheckToken&&(a[Pi]=this.appCheckToken),ga(n,pa,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Ep(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Lp)),up(()=>{if(this.isClosed_)return;this.scriptTagHolder=new as((...r)=>{const[o,l,a,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Cr)this.id=l,this.password=a;else if(o===Ip)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,l]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const i={};i[Cr]="t",i[ya]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Rp]=this.scriptTagHolder.uniqueCallbackIdentifier),i[oa]=rs,this.transportSessionId&&(i[aa]=this.transportSessionId),this.lastSessionId&&(i[da]=this.lastSessionId),this.applicationId&&(i[ha]=this.applicationId),this.appCheckToken&&(i[Pi]=this.appCheckToken),typeof location<"u"&&location.hostname&&ua.test(location.hostname)&&(i[la]=ca);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){lt.forceAllow_=!0}static forceDisallow(){lt.forceDisallow_=!0}static isAvailable(){return lt.forceAllow_?!0:!lt.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!hp()&&!fp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ee(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=Yl(n),s=sa(i,kp);for(let r=0;r<s.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[Mp]="t",i[_a]=e,i[va]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ee(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class as{constructor(e,n,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ap(),window[xp+this.uniqueCallbackIdentifier]=e,window[Tp+this.uniqueCallbackIdentifier]=n,this.myIFrame=as.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){oe("frame writing exception"),l.stack&&oe(l.stack),oe(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||oe("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_a]=this.myID,e[va]=this.myPW,e[ya]=this.currentSerial;let n=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ca+i.length<=ba;){const o=this.pendingSegs.shift();i=i+"&"+Op+s+"="+o.seg+"&"+Pp+s+"="+o.ts+"&"+Np+s+"="+o.d,s++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(i,Math.floor(Ap)),r=()=>{clearTimeout(s),i()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{oe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=16384,Fp=45e3;let wn=null;typeof MozWebSocket<"u"?wn=MozWebSocket:typeof WebSocket<"u"&&(wn=WebSocket);class ye{constructor(e,n,i,s,r,o,l){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=zt(this.connId),this.stats_=os(n),this.connURL=ye.connectionURL_(n,o,l,s,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,i,s,r){const o={};return o[oa]=rs,typeof location<"u"&&location.hostname&&ua.test(location.hostname)&&(o[la]=ca),n&&(o[aa]=n),i&&(o[da]=i),s&&(o[Pi]=s),r&&(o[ha]=r),ga(e,fa,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Xe.set("previous_websocket_failure",!0);try{let i;ro(),this.mySock=new wn(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){ye.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&wn!==null&&!ye.forceDisallow_}static previouslyFailed(){return Xe.isInMemoryStorage||Xe.get("previous_websocket_failure")===!0}markConnectionHealthy(){Xe.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=Wi(n);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(b(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const n=ee(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=sa(n,Dp);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Fp))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ye.responsesRequiredToBeHealthy=2;ye.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[lt,ye]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=ye&&ye.isAvailable();let i=n&&!ye.previouslyFailed();if(e.webSocketOnly&&(n||me("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ye];else{const s=this.transports_=[];for(const r of Dt.ALL_TRANSPORTS)r&&r.isAvailable()&&s.push(r);Dt.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Dt.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=6e4,$p=5e3,jp=10*1024,Wp=100*1024,_i="t",Sr="d",Hp="s",wr="r",Up="e",Er="o",Ir="a",xr="n",Tr="p",Bp="h";class qp{constructor(e,n,i,s,r,o,l,a,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=r,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=zt("c:"+this.id+":"),this.transportManager_=new Dt(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Ot(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Wp?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>jp?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(_i in e){const n=e[_i];n===Ir?this.upgradeIfSecondaryHealthy_():n===wr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Er&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=wt("t",e),i=wt("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Tr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ir,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:xr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=wt("t",e),i=wt("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=wt(_i,e);if(Sr in e){const i=e[Sr];if(n===Bp){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===xr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Hp?this.onConnectionShutdown_(i):n===wr?this.onReset_(i):n===Up?Oi("Server Error: "+i):n===Er?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Oi("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),rs!==i&&me("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Ot(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Vp))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ot(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($p))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Tr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Xe.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{put(e,n,i,s){}merge(e,n,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.allowedEvents_=e,this.listeners_={},b(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});const s=this.getInitialEvent(e);s&&n.apply(i,s)}off(e,n,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let r=0;r<s.length;r++)if(s[r].callback===n&&(!i||i===s[r].context)){s.splice(r,1);return}}validateEventType_(e){b(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En extends wa{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ao()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new En}getInitialEvent(e){return b(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=32,Or=768;class W{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function V(){return new W("")}function A(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ge(t){return t.pieces_.length-t.pieceNum_}function H(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new W(t.pieces_,e)}function Ea(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function zp(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ia(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function xa(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new W(e,0)}function Q(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof W)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&n.push(i[s])}return new W(n,0)}function M(t){return t.pieceNum_>=t.pieces_.length}function ce(t,e){const n=A(t),i=A(e);if(n===null)return e;if(n===i)return ce(H(t),H(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function ls(t,e){if(Ge(t)!==Ge(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function be(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Ge(t)>Ge(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class Gp{constructor(e,n){this.errorPrefix_=n,this.parts_=Ia(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Dn(this.parts_[i]);Ta(this)}}function Yp(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Dn(e),Ta(t)}function Kp(t){const e=t.parts_.pop();t.byteLength_-=Dn(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ta(t){if(t.byteLength_>Or)throw new Error(t.errorPrefix_+"has a key path longer than "+Or+" bytes ("+t.byteLength_+").");if(t.parts_.length>Rr)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Rr+") or object contains a cycle "+Qe(t))}function Qe(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends wa{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new cs}getInitialEvent(e){return b(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et=1e3,Qp=60*5*1e3,Pr=30*1e3,Xp=1.3,Zp=3e4,Jp="server_kill",Nr=3;class Le extends Sa{constructor(e,n,i,s,r,o,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Le.nextPersistentConnectionId_++,this.log_=zt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Et,this.maxReconnectDelay_=Qp,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!ro())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");cs.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&En.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,i){const s=++this.requestNumber_,r={r:s,a:e,b:n};this.log_(ee(r)),b(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const n=new oo,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,i,s){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),b(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),b(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:i};this.listens.get(o).set(r,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(e){const n=e.query,i=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+i+" for "+s);const r={p:i},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,l=>{const a=l.d,c=l.s;Le.warnOnListenWarnings_(a,n),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Te(e,"w")){const i=ft(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();me(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Hl(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Pr)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Ul(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,s=>{const r=s.s,o=s.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,i=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(e,n){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),b(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,n)}sendUnlisten_(e,n,i,s){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";s&&(r.q=i,r.t=s),this.sendRequest(o,r)}onDisconnectPut(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:i})}onDisconnectMerge(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:i})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,i,s){const r={p:n,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,i,s){this.putInternal("p",e,n,i,s)}merge(e,n,i,s){this.putInternal("m",e,n,i,s)}putInternal(e,n,i,s,r){this.initConnection_();const o={p:n,d:i};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,i,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const r=i.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ee(e));const n=e.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Oi("Unrecognized action received from server: "+ee(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){b(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Zp&&(this.reconnectDelay_=Et),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Xp)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Le.nextConnectionId_++,r=this.lastSessionId;let o=!1,l=null;const a=function(){l?l.close():(o=!0,i())},c=function(d){b(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?oe("getToken() completed but was canceled"):(oe("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=h&&h.token,l=new qp(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,i,f=>{me(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(Jp)},r))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&me(d),a())}}}interrupt(e){oe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){oe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],js(this.interruptReasons_)&&(this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let i;n?i=n.map(r=>ss(r)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const i=new W(e).toString();let s;if(this.listens.has(i)){const r=this.listens.get(i);s=r.get(n),r.delete(n),r.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,n){oe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Nr&&(this.reconnectDelay_=Pr,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){oe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Nr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ta.replace(/\./g,"-")]=1,ao()?e["framework.cordova"]=1:Bl()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=En.getInstance().currentlyOnline();return js(this.interruptReasons_)&&e}}Le.nextPersistentConnectionId_=0;Le.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new k(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const i=new k(Je,e),s=new k(Je,n);return this.compare(i,s)!==0}minPost(){return k.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let an;class Ra extends Xn{static get __EMPTY_NODE(){return an}static set __EMPTY_NODE(e){an=e}compare(e,n){return vt(e.name,n.name)}isDefinedOn(e){throw Ut("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return k.MIN}maxPost(){return new k($e,an)}makePost(e,n){return b(typeof e=="string","KeyIndex indexValue must always be a string."),new k(e,an)}toString(){return".key"}}const De=new Ra;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n,i,s,r=null){this.isReverse_=s,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class J{constructor(e,n,i,s,r){this.key=e,this.value=n,this.color=i??J.RED,this.left=s??ue.EMPTY_NODE,this.right=r??ue.EMPTY_NODE}copy(e,n,i,s,r){return new J(e??this.key,n??this.value,i??this.color,s??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let s=this;const r=i(e,s.key);return r<0?s=s.copy(null,null,null,s.left.insert(e,n,i),null):r===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ue.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let i,s;if(i=this,n(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(e,i.key)===0){if(i.right.isEmpty())return ue.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,J.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,J.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}J.RED=!0;J.BLACK=!1;class em{copy(e,n,i,s,r){return this}insert(e,n,i){return new J(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ue{constructor(e,n=ue.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new ue(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,J.BLACK,null,null))}remove(e){return new ue(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,J.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,s=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ln(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ln(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ln(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ln(this.root_,null,this.comparator_,!0,e)}}ue.EMPTY_NODE=new em;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t,e){return vt(t.name,e.name)}function us(t,e){return vt(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ni;function nm(t){Ni=t}const Oa=function(t){return typeof t=="number"?"number:"+ra(t):"string:"+t},Pa=function(t){if(t.isLeafNode()){const e=t.val();b(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Te(e,".sv"),"Priority must be a string or number.")}else b(t===Ni||t.isEmpty(),"priority of unexpected type.");b(t===Ni||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mr;class Z{constructor(e,n=Z.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,b(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Pa(this.priorityNode_)}static set __childrenNodeConstructor(e){Mr=e}static get __childrenNodeConstructor(){return Mr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Z(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Z.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return M(e)?this:A(e)===".priority"?this.priorityNode_:Z.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Z.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const i=A(e);return i===null?n:n.isEmpty()&&i!==".priority"?this:(b(i!==".priority"||Ge(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Z.__childrenNodeConstructor.EMPTY_NODE.updateChild(H(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Oa(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ra(this.value_):e+=this.value_,this.lazyHash_=ia(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Z.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Z.__childrenNodeConstructor?-1:(b(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,i=typeof this.value_,s=Z.VALUE_TYPE_ORDER.indexOf(n),r=Z.VALUE_TYPE_ORDER.indexOf(i);return b(s>=0,"Unknown leaf type: "+n),b(r>=0,"Unknown leaf type: "+i),s===r?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Z.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na,Ma;function im(t){Na=t}function sm(t){Ma=t}class rm extends Xn{compare(e,n){const i=e.node.getPriority(),s=n.node.getPriority(),r=i.compareTo(s);return r===0?vt(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return k.MIN}maxPost(){return new k($e,new Z("[PRIORITY-POST]",Ma))}makePost(e,n){const i=Na(e);return new k(n,new Z("[PRIORITY-POST]",i))}toString(){return".priority"}}const B=new rm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om=Math.log(2);class am{constructor(e){const n=r=>parseInt(Math.log(r)/om,10),i=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const In=function(t,e,n,i){t.sort(e);const s=function(a,c){const u=c-a;let d,h;if(u===0)return null;if(u===1)return d=t[a],h=n?n(d):d,new J(h,d.node,J.BLACK,null,null);{const f=parseInt(u/2,10)+a,p=s(a,f),m=s(f+1,c);return d=t[f],h=n?n(d):d,new J(h,d.node,J.BLACK,p,m)}},r=function(a){let c=null,u=null,d=t.length;const h=function(p,m){const g=d-p,_=d;d-=p;const C=s(g+1,_),S=t[g],T=n?n(S):S;f(new J(T,S.node,m,null,C))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<a.count;++p){const m=a.nextBitIsOne(),g=Math.pow(2,a.count-(p+1));m?h(g,J.BLACK):(h(g,J.BLACK),h(g,J.RED))}return u},o=new am(t.length),l=r(o);return new ue(i||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vi;const at={};class ke{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return b(at&&B,"ChildrenNode.ts has not been loaded"),vi=vi||new ke({".priority":at},{".priority":B}),vi}get(e){const n=ft(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ue?n:null}hasIndex(e){return Te(this.indexSet_,e.toString())}addIndex(e,n){b(e!==De,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const r=n.getIterator(k.Wrap);let o=r.getNext();for(;o;)s=s||e.isDefinedOn(o.node),i.push(o),o=r.getNext();let l;s?l=In(i,e.getCompare()):l=at;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new ke(u,c)}addToIndexes(e,n){const i=pn(this.indexes_,(s,r)=>{const o=ft(this.indexSet_,r);if(b(o,"Missing index implementation for "+r),s===at)if(o.isDefinedOn(e.node)){const l=[],a=n.getIterator(k.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),In(l,o.getCompare())}else return at;else{const l=n.get(e.name);let a=s;return l&&(a=a.remove(new k(e.name,l))),a.insert(e,e.node)}});return new ke(i,this.indexSet_)}removeFromIndexes(e,n){const i=pn(this.indexes_,s=>{if(s===at)return s;{const r=n.get(e.name);return r?s.remove(new k(e.name,r)):s}});return new ke(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let It;class R{constructor(e,n,i){this.children_=e,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Pa(this.priorityNode_),this.children_.isEmpty()&&b(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return It||(It=new R(new ue(us),null,ke.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||It}updatePriority(e){return this.children_.isEmpty()?this:new R(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?It:n}}getChild(e){const n=A(e);return n===null?this:this.getImmediateChild(n).getChild(H(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(b(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const i=new k(e,n);let s,r;n.isEmpty()?(s=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(i,this.children_));const o=s.isEmpty()?It:this.priorityNode_;return new R(s,o,r)}}updateChild(e,n){const i=A(e);if(i===null)return n;{b(A(e)!==".priority"||Ge(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(H(e),n);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let i=0,s=0,r=!0;if(this.forEachChild(B,(o,l)=>{n[o]=l.val(e),i++,r&&R.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):r=!1}),!e&&r&&s<2*i){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Oa(this.getPriority().val())+":"),this.forEachChild(B,(n,i)=>{const s=i.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":ia(e)}return this.lazyHash_}getPredecessorChildName(e,n,i){const s=this.resolveIndex_(i);if(s){const r=s.getPredecessorKey(new k(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new k(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new k(n,this.children_.get(n)):null}forEachChild(e,n){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,k.Wrap);let r=s.peek();for(;r!=null&&n.compare(r,e)<0;)s.getNext(),r=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,k.Wrap);let r=s.peek();for(;r!=null&&n.compare(r,e)>0;)s.getNext(),r=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Yt?-1:0}withIndex(e){if(e===De||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new R(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===De||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(B),s=n.getIterator(B);let r=i.getNext(),o=s.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=i.getNext(),o=s.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===De?null:this.indexMap_.get(e.toString())}}R.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class lm extends R{constructor(){super(new ue(us),R.EMPTY_NODE,ke.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return R.EMPTY_NODE}isEmpty(){return!1}}const Yt=new lm;Object.defineProperties(k,{MIN:{value:new k(Je,R.EMPTY_NODE)},MAX:{value:new k($e,Yt)}});Ra.__EMPTY_NODE=R.EMPTY_NODE;Z.__childrenNodeConstructor=R;nm(Yt);sm(Yt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm=!0;function ae(t,e=null){if(t===null)return R.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),b(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Z(n,ae(e))}if(!(t instanceof Array)&&cm){const n=[];let i=!1;if(he(t,(o,l)=>{if(o.substring(0,1)!=="."){const a=ae(l);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),n.push(new k(o,a)))}}),n.length===0)return R.EMPTY_NODE;const r=In(n,tm,o=>o.name,us);if(i){const o=In(n,B.getCompare());return new R(r,ae(e),new ke({".priority":o},{".priority":B}))}else return new R(r,ae(e),ke.Default)}else{let n=R.EMPTY_NODE;return he(t,(i,s)=>{if(Te(t,i)&&i.substring(0,1)!=="."){const r=ae(s);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(i,r))}}),n.updatePriority(ae(e))}}im(ae);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends Xn{constructor(e){super(),this.indexPath_=e,b(!M(e)&&A(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const i=this.extractChild(e.node),s=this.extractChild(n.node),r=i.compareTo(s);return r===0?vt(e.name,n.name):r}makePost(e,n){const i=ae(e),s=R.EMPTY_NODE.updateChild(this.indexPath_,i);return new k(n,s)}maxPost(){const e=R.EMPTY_NODE.updateChild(this.indexPath_,Yt);return new k($e,e)}toString(){return Ia(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um extends Xn{compare(e,n){const i=e.node.compareTo(n.node);return i===0?vt(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return k.MIN}maxPost(){return k.MAX}makePost(e,n){const i=ae(e);return new k(n,i)}toString(){return".value"}}const ka=new um;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(t){return{type:"value",snapshotNode:t}}function mt(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ft(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Vt(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function dm(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this.index_=e}updateChild(e,n,i,s,r,o){b(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Ft(n,l)):b(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(mt(n,i)):o.trackChildChange(Vt(n,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(B,(s,r)=>{n.hasChild(s)||i.trackChildChange(Ft(s,r))}),n.isLeafNode()||n.forEachChild(B,(s,r)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(r)||i.trackChildChange(Vt(s,r,o))}else i.trackChildChange(mt(s,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?R.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.indexedFilter_=new hs(e.getIndex()),this.index_=e.getIndex(),this.startPost_=$t.getStartPost_(e),this.endPost_=$t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,s,r,o){return this.matches(new k(n,i))||(i=R.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,s,r,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=R.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(R.EMPTY_NODE);const r=this;return n.forEachChild(B,(o,l)=>{r.matches(new k(o,l))||(s=s.updateImmediateChild(o,R.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{const i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new $t(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,s,r,o){return this.rangedFilter_.matches(new k(n,i))||(i=R.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,s,r,o):this.fullLimitUpdateChild_(e,n,i,r,o)}updateFullNode(e,n,i){let s;if(n.isLeafNode()||n.isEmpty())s=R.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=R.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const l=r.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(R.EMPTY_NODE);let r;this.reverse_?r=s.getReverseIterator(this.index_):r=s.getIterator(this.index_);let o=0;for(;r.hasNext();){const l=r.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:s=s.updateImmediateChild(l.name,R.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,s,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();const l=e;b(l.numChildren()===this.limit_,"");const a=new k(n,i),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(n)){const d=l.getImmediateChild(n);let h=s.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||l.hasChild(h.name));)h=s.getChildAfterChild(this.index_,h,this.reverse_);const f=h==null?1:o(h,a);if(u&&!i.isEmpty()&&f>=0)return r!=null&&r.trackChildChange(Vt(n,i,d)),l.updateImmediateChild(n,i);{r!=null&&r.trackChildChange(Ft(n,d));const m=l.updateImmediateChild(n,R.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(mt(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return i.isEmpty()?e:u&&o(c,a)>=0?(r!=null&&(r.trackChildChange(Ft(c.name,c.node)),r.trackChildChange(mt(n,i))),l.updateImmediateChild(n,i).updateImmediateChild(c.name,R.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=B}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return b(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return b(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Je}hasEnd(){return this.endSet_}getIndexEndValue(){return b(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return b(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$e}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return b(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===B}copy(){const e=new fs;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function fm(t){return t.loadsAllData()?new hs(t.getIndex()):t.hasLimit()?new hm(t):new $t(t)}function kr(t,e,n){const i=t.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,n!=null?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function pm(t,e,n){let i;return t.index_===De||n?i=kr(t,e,n):i=kr(t,e,$e),i.startAfterSet_=!0,i}function mm(t,e,n){const i=t.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,n!==void 0?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function La(t,e){const n=t.copy();return n.index_=e,n}function Ar(t){const e={};if(t.isDefault())return e;let n;if(t.index_===B?n="$priority":t.index_===ka?n="$value":t.index_===De?n="$key":(b(t.index_ instanceof ds,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ee(n),t.startSet_){const i=t.startAfterSet_?"startAfter":"startAt";e[i]=ee(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+ee(t.indexStartName_))}if(t.endSet_){const i=t.endBeforeSet_?"endBefore":"endAt";e[i]=ee(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+ee(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Lr(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==B&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn extends Sa{constructor(e,n,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=zt("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(b(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,s){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=xn.getListenId_(e,i),l={};this.listens_[o]=l;const a=Ar(e._queryParams);this.restRequest_(r+".json",a,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(r,d,!1,i),ft(this.listens_,o)===l){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",s(h,null)}})}unlisten(e,n){const i=xn.getListenId_(e,n);delete this.listens_[i]}get(e){const n=Ar(e._queryParams),i=e._path.toString(),s=new oo;return this.restRequest_(i+".json",n,(r,o)=>{let l=o;r===404&&(l=null,r=null),r===null?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,r])=>{s&&s.accessToken&&(n.auth=s.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ql(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=Wi(l.responseText)}catch{me("Failed to parse JSON response for "+o+": "+l.responseText)}i(null,a)}else l.status!==401&&l.status!==404&&me("Got unsuccessful REST response for "+o+" Status: "+l.status),i(l.status);i=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(){this.rootNode_=R.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(){return{value:null,children:new Map}}function Da(t,e,n){if(M(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const i=A(e);t.children.has(i)||t.children.set(i,Tn());const s=t.children.get(i);e=H(e),Da(s,e,n)}}function Mi(t,e,n){t.value!==null?n(e,t.value):_m(t,(i,s)=>{const r=new W(e.toString()+"/"+i);Mi(s,r,n)})}function _m(t,e){t.children.forEach((n,i)=>{e(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&he(this.last_,(i,s)=>{n[i]=n[i]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr=10*1e3,ym=30*1e3,bm=5*60*1e3;class Cm{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new vm(e);const i=Dr+(ym-Dr)*Math.random();Ot(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),n={};let i=!1;he(e,(s,r)=>{r>0&&Te(this.statsToReport_,s)&&(n[s]=r,i=!0)}),i&&this.server_.reportStats(n),Ot(this.reportStats_.bind(this),Math.floor(Math.random()*2*bm))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ce||(Ce={}));function Fa(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ps(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ms(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Ce.ACK_USER_WRITE,this.source=Fa()}operationForChild(e){if(M(this.path)){if(this.affectedTree.value!=null)return b(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new W(e));return new Rn(V(),n,this.revert)}}else return b(A(this.path)===e,"operationForChild called for unrelated child."),new Rn(H(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,n){this.source=e,this.path=n,this.type=Ce.LISTEN_COMPLETE}operationForChild(e){return M(this.path)?new jt(this.source,V()):new jt(this.source,H(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Ce.OVERWRITE}operationForChild(e){return M(this.path)?new et(this.source,V(),this.snap.getImmediateChild(e)):new et(this.source,H(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Ce.MERGE}operationForChild(e){if(M(this.path)){const n=this.children.subtree(new W(e));return n.isEmpty()?null:n.value?new et(this.source,V(),n.value):new Wt(this.source,V(),n)}else return b(A(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Wt(this.source,H(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(M(e))return this.isFullyInitialized()&&!this.filtered_;const n=A(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function wm(t,e,n,i){const s=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(dm(o.childName,o.snapshotNode))}),xt(t,s,"child_removed",e,i,n),xt(t,s,"child_added",e,i,n),xt(t,s,"child_moved",r,i,n),xt(t,s,"child_changed",e,i,n),xt(t,s,"value",e,i,n),s}function xt(t,e,n,i,s,r){const o=i.filter(l=>l.type===n);o.sort((l,a)=>Im(t,l,a)),o.forEach(l=>{const a=Em(t,l,r);s.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,t.query_))})})}function Em(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Im(t,e,n){if(e.childName==null||n.childName==null)throw Ut("Should only compare child_ events.");const i=new k(e.childName,e.snapshotNode),s=new k(n.childName,n.snapshotNode);return t.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(t,e){return{eventCache:t,serverCache:e}}function Pt(t,e,n,i){return Zn(new tt(e,n,i),t.serverCache)}function Va(t,e,n,i){return Zn(t.eventCache,new tt(e,n,i))}function ki(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function nt(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yi;const xm=()=>(yi||(yi=new ue(dp)),yi);class U{constructor(e,n=xm()){this.value=e,this.children=n}static fromObject(e){let n=new U(null);return he(e,(i,s)=>{n=n.set(new W(i),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:V(),value:this.value};if(M(e))return null;{const i=A(e),s=this.children.get(i);if(s!==null){const r=s.findRootMostMatchingPathAndValue(H(e),n);return r!=null?{path:Q(new W(i),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(M(e))return this;{const n=A(e),i=this.children.get(n);return i!==null?i.subtree(H(e)):new U(null)}}set(e,n){if(M(e))return new U(n,this.children);{const i=A(e),r=(this.children.get(i)||new U(null)).set(H(e),n),o=this.children.insert(i,r);return new U(this.value,o)}}remove(e){if(M(e))return this.children.isEmpty()?new U(null):new U(null,this.children);{const n=A(e),i=this.children.get(n);if(i){const s=i.remove(H(e));let r;return s.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,s),this.value===null&&r.isEmpty()?new U(null):new U(this.value,r)}else return this}}get(e){if(M(e))return this.value;{const n=A(e),i=this.children.get(n);return i?i.get(H(e)):null}}setTree(e,n){if(M(e))return n;{const i=A(e),r=(this.children.get(i)||new U(null)).setTree(H(e),n);let o;return r.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,r),new U(this.value,o)}}fold(e){return this.fold_(V(),e)}fold_(e,n){const i={};return this.children.inorderTraversal((s,r)=>{i[s]=r.fold_(Q(e,s),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,V(),n)}findOnPath_(e,n,i){const s=this.value?i(n,this.value):!1;if(s)return s;if(M(e))return null;{const r=A(e),o=this.children.get(r);return o?o.findOnPath_(H(e),Q(n,r),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,V(),n)}foreachOnPath_(e,n,i){if(M(e))return this;{this.value&&i(n,this.value);const s=A(e),r=this.children.get(s);return r?r.foreachOnPath_(H(e),Q(n,s),i):new U(null)}}foreach(e){this.foreach_(V(),e)}foreach_(e,n){this.children.inorderTraversal((i,s)=>{s.foreach_(Q(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.writeTree_=e}static empty(){return new Se(new U(null))}}function Nt(t,e,n){if(M(e))return new Se(new U(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let r=i.value;const o=ce(s,e);return r=r.updateChild(o,n),new Se(t.writeTree_.set(s,r))}else{const s=new U(n),r=t.writeTree_.setTree(e,s);return new Se(r)}}}function Fr(t,e,n){let i=t;return he(n,(s,r)=>{i=Nt(i,Q(e,s),r)}),i}function Vr(t,e){if(M(e))return Se.empty();{const n=t.writeTree_.setTree(e,new U(null));return new Se(n)}}function Ai(t,e){return it(t,e)!=null}function it(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(ce(n.path,e)):null}function $r(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(B,(i,s)=>{e.push(new k(i,s))}):t.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new k(i,s.value))}),e}function ze(t,e){if(M(e))return t;{const n=it(t,e);return n!=null?new Se(new U(n)):new Se(t.writeTree_.subtree(e))}}function Li(t){return t.writeTree_.isEmpty()}function gt(t,e){return $a(V(),t.writeTree_,e)}function $a(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((s,r)=>{s===".priority"?(b(r.value!==null,"Priority writes must always be leaf nodes"),i=r.value):n=$a(Q(t,s),r,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(Q(t,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(t,e){return Ua(e,t)}function Tm(t,e,n,i,s){b(i>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:s}),s&&(t.visibleWrites=Nt(t.visibleWrites,e,n)),t.lastWriteId=i}function Rm(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}function Om(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);b(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let s=i.visible,r=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&Pm(l,i.path)?s=!1:be(i.path,l.path)&&(r=!0)),o--}if(s){if(r)return Nm(t),!0;if(i.snap)t.visibleWrites=Vr(t.visibleWrites,i.path);else{const l=i.children;he(l,a=>{t.visibleWrites=Vr(t.visibleWrites,Q(i.path,a))})}return!0}else return!1}function Pm(t,e){if(t.snap)return be(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&be(Q(t.path,n),e))return!0;return!1}function Nm(t){t.visibleWrites=ja(t.allWrites,Mm,V()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Mm(t){return t.visible}function ja(t,e,n){let i=Se.empty();for(let s=0;s<t.length;++s){const r=t[s];if(e(r)){const o=r.path;let l;if(r.snap)be(n,o)?(l=ce(n,o),i=Nt(i,l,r.snap)):be(o,n)&&(l=ce(o,n),i=Nt(i,V(),r.snap.getChild(l)));else if(r.children){if(be(n,o))l=ce(n,o),i=Fr(i,l,r.children);else if(be(o,n))if(l=ce(o,n),M(l))i=Fr(i,V(),r.children);else{const a=ft(r.children,A(l));if(a){const c=a.getChild(H(l));i=Nt(i,V(),c)}}}else throw Ut("WriteRecord should have .snap or .children")}}return i}function Wa(t,e,n,i,s){if(!i&&!s){const r=it(t.visibleWrites,e);if(r!=null)return r;{const o=ze(t.visibleWrites,e);if(Li(o))return n;if(n==null&&!Ai(o,V()))return null;{const l=n||R.EMPTY_NODE;return gt(o,l)}}}else{const r=ze(t.visibleWrites,e);if(!s&&Li(r))return n;if(!s&&n==null&&!Ai(r,V()))return null;{const o=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(be(c.path,e)||be(e,c.path))},l=ja(t.allWrites,o,e),a=n||R.EMPTY_NODE;return gt(l,a)}}}function km(t,e,n){let i=R.EMPTY_NODE;const s=it(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(B,(r,o)=>{i=i.updateImmediateChild(r,o)}),i;if(n){const r=ze(t.visibleWrites,e);return n.forEachChild(B,(o,l)=>{const a=gt(ze(r,new W(o)),l);i=i.updateImmediateChild(o,a)}),$r(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const r=ze(t.visibleWrites,e);return $r(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Am(t,e,n,i,s){b(i||s,"Either existingEventSnap or existingServerSnap must exist");const r=Q(e,n);if(Ai(t.visibleWrites,r))return null;{const o=ze(t.visibleWrites,r);return Li(o)?s.getChild(n):gt(o,s.getChild(n))}}function Lm(t,e,n,i){const s=Q(e,n),r=it(t.visibleWrites,s);if(r!=null)return r;if(i.isCompleteForChild(n)){const o=ze(t.visibleWrites,s);return gt(o,i.getNode().getImmediateChild(n))}else return null}function Dm(t,e){return it(t.visibleWrites,e)}function Fm(t,e,n,i,s,r,o){let l;const a=ze(t.visibleWrites,e),c=it(a,V());if(c!=null)l=c;else if(n!=null)l=gt(a,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const u=[],d=o.getCompare(),h=r?l.getReverseIteratorFrom(i,o):l.getIteratorFrom(i,o);let f=h.getNext();for(;f&&u.length<s;)d(f,i)!==0&&u.push(f),f=h.getNext();return u}else return[]}function Vm(){return{visibleWrites:Se.empty(),allWrites:[],lastWriteId:-1}}function On(t,e,n,i){return Wa(t.writeTree,t.treePath,e,n,i)}function _s(t,e){return km(t.writeTree,t.treePath,e)}function jr(t,e,n,i){return Am(t.writeTree,t.treePath,e,n,i)}function Pn(t,e){return Dm(t.writeTree,Q(t.treePath,e))}function $m(t,e,n,i,s,r){return Fm(t.writeTree,t.treePath,e,n,i,s,r)}function vs(t,e,n){return Lm(t.writeTree,t.treePath,e,n)}function Ha(t,e){return Ua(Q(t.treePath,e),t.writeTree)}function Ua(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,i=e.childName;b(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),b(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const r=s.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(i,Vt(i,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(i,Ft(i,s.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(i,mt(i,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(i,Vt(i,e.snapshotNode,s.oldSnap));else throw Ut("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}}const Ba=new Wm;class ys{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new tt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return vs(this.writes_,e,i)}}getChildAfterChild(e,n,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:nt(this.viewCache_),r=$m(this.writes_,s,n,1,i,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(t){return{filter:t}}function Um(t,e){b(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),b(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Bm(t,e,n,i,s){const r=new jm;let o,l;if(n.type===Ce.OVERWRITE){const c=n;c.source.fromUser?o=Di(t,e,c.path,c.snap,i,s,r):(b(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!M(c.path),o=Nn(t,e,c.path,c.snap,i,s,l,r))}else if(n.type===Ce.MERGE){const c=n;c.source.fromUser?o=zm(t,e,c.path,c.children,i,s,r):(b(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),o=Fi(t,e,c.path,c.children,i,s,l,r))}else if(n.type===Ce.ACK_USER_WRITE){const c=n;c.revert?o=Km(t,e,c.path,i,s,r):o=Gm(t,e,c.path,c.affectedTree,i,s,r)}else if(n.type===Ce.LISTEN_COMPLETE)o=Ym(t,e,n.path,i,r);else throw Ut("Unknown operation type: "+n.type);const a=r.getChanges();return qm(e,o,a),{viewCache:o,changes:a}}function qm(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=ki(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(Aa(ki(e)))}}function qa(t,e,n,i,s,r){const o=e.eventCache;if(Pn(i,n)!=null)return e;{let l,a;if(M(n))if(b(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=nt(e),u=c instanceof R?c:R.EMPTY_NODE,d=_s(i,u);l=t.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const c=On(i,nt(e));l=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=A(n);if(c===".priority"){b(Ge(n)===1,"Can't have a priority with additional path components");const u=o.getNode();a=e.serverCache.getNode();const d=jr(i,n,u,a);d!=null?l=t.filter.updatePriority(u,d):l=o.getNode()}else{const u=H(n);let d;if(o.isCompleteForChild(c)){a=e.serverCache.getNode();const h=jr(i,n,o.getNode(),a);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=vs(i,c,e.serverCache);d!=null?l=t.filter.updateChild(o.getNode(),c,d,u,s,r):l=o.getNode()}}return Pt(e,l,o.isFullyInitialized()||M(n),t.filter.filtersNodes())}}function Nn(t,e,n,i,s,r,o,l){const a=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(M(n))c=u.updateFullNode(a.getNode(),i,null);else if(u.filtersNodes()&&!a.isFiltered()){const f=a.getNode().updateChild(n,i);c=u.updateFullNode(a.getNode(),f,null)}else{const f=A(n);if(!a.isCompleteForPath(n)&&Ge(n)>1)return e;const p=H(n),g=a.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=u.updatePriority(a.getNode(),g):c=u.updateChild(a.getNode(),f,g,p,Ba,null)}const d=Va(e,c,a.isFullyInitialized()||M(n),u.filtersNodes()),h=new ys(s,d,r);return qa(t,d,n,s,h,l)}function Di(t,e,n,i,s,r,o){const l=e.eventCache;let a,c;const u=new ys(s,e,r);if(M(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),a=Pt(e,c,!0,t.filter.filtersNodes());else{const d=A(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),a=Pt(e,c,l.isFullyInitialized(),l.isFiltered());else{const h=H(n),f=l.getNode().getImmediateChild(d);let p;if(M(h))p=i;else{const m=u.getCompleteChild(d);m!=null?Ea(h)===".priority"&&m.getChild(xa(h)).isEmpty()?p=m:p=m.updateChild(h,i):p=R.EMPTY_NODE}if(f.equals(p))a=e;else{const m=t.filter.updateChild(l.getNode(),d,p,h,u,o);a=Pt(e,m,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function Wr(t,e){return t.eventCache.isCompleteForChild(e)}function zm(t,e,n,i,s,r,o){let l=e;return i.foreach((a,c)=>{const u=Q(n,a);Wr(e,A(u))&&(l=Di(t,l,u,c,s,r,o))}),i.foreach((a,c)=>{const u=Q(n,a);Wr(e,A(u))||(l=Di(t,l,u,c,s,r,o))}),l}function Hr(t,e,n){return n.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Fi(t,e,n,i,s,r,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;M(n)?c=i:c=new U(null).setTree(n,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const f=e.serverCache.getNode().getImmediateChild(d),p=Hr(t,f,h);a=Nn(t,a,new W(d),p,s,r,o,l)}}),c.children.inorderTraversal((d,h)=>{const f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){const p=e.serverCache.getNode().getImmediateChild(d),m=Hr(t,p,h);a=Nn(t,a,new W(d),m,s,r,o,l)}}),a}function Gm(t,e,n,i,s,r,o){if(Pn(s,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(M(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return Nn(t,e,n,a.getNode().getChild(n),s,r,l,o);if(M(n)){let c=new U(null);return a.getNode().forEachChild(De,(u,d)=>{c=c.set(new W(u),d)}),Fi(t,e,n,c,s,r,l,o)}else return e}else{let c=new U(null);return i.foreach((u,d)=>{const h=Q(n,u);a.isCompleteForPath(h)&&(c=c.set(u,a.getNode().getChild(h)))}),Fi(t,e,n,c,s,r,l,o)}}function Ym(t,e,n,i,s){const r=e.serverCache,o=Va(e,r.getNode(),r.isFullyInitialized()||M(n),r.isFiltered());return qa(t,o,n,i,Ba,s)}function Km(t,e,n,i,s,r){let o;if(Pn(i,n)!=null)return e;{const l=new ys(i,e,s),a=e.eventCache.getNode();let c;if(M(n)||A(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=On(i,nt(e));else{const d=e.serverCache.getNode();b(d instanceof R,"serverChildren would be complete if leaf node"),u=_s(i,d)}u=u,c=t.filter.updateFullNode(a,u,r)}else{const u=A(n);let d=vs(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=a.getImmediateChild(u)),d!=null?c=t.filter.updateChild(a,u,d,H(n),l,r):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(a,u,R.EMPTY_NODE,H(n),l,r):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=On(i,nt(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||Pn(i,V())!=null,Pt(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new hs(i.getIndex()),r=fm(i);this.processor_=Hm(r);const o=n.serverCache,l=n.eventCache,a=s.updateFullNode(R.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(R.EMPTY_NODE,l.getNode(),null),u=new tt(a,o.isFullyInitialized(),s.filtersNodes()),d=new tt(c,l.isFullyInitialized(),r.filtersNodes());this.viewCache_=Zn(d,u),this.eventGenerator_=new Sm(this.query_)}get query(){return this.query_}}function Xm(t){return t.viewCache_.serverCache.getNode()}function Zm(t,e){const n=nt(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!M(e)&&!n.getImmediateChild(A(e)).isEmpty())?n.getChild(e):null}function Ur(t){return t.eventRegistrations_.length===0}function Jm(t,e){t.eventRegistrations_.push(e)}function Br(t,e,n){const i=[];if(n){b(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,s);o&&i.push(o)})}if(e){let s=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return i}function qr(t,e,n,i){e.type===Ce.MERGE&&e.source.queryId!==null&&(b(nt(t.viewCache_),"We should always have a full cache before handling merges"),b(ki(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,r=Bm(t.processor_,s,e,n,i);return Um(t.processor_,r.viewCache),b(r.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,za(t,r.changes,r.viewCache.eventCache.getNode(),null)}function eg(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(B,(r,o)=>{i.push(mt(r,o))}),n.isFullyInitialized()&&i.push(Aa(n.getNode())),za(t,i,n.getNode(),e)}function za(t,e,n,i){const s=i?[i]:t.eventRegistrations_;return wm(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mn;class tg{constructor(){this.views=new Map}}function ng(t){b(!Mn,"__referenceConstructor has already been defined"),Mn=t}function ig(){return b(Mn,"Reference.ts has not been loaded"),Mn}function sg(t){return t.views.size===0}function bs(t,e,n,i){const s=e.source.queryId;if(s!==null){const r=t.views.get(s);return b(r!=null,"SyncTree gave us an op for an invalid query."),qr(r,e,n,i)}else{let r=[];for(const o of t.views.values())r=r.concat(qr(o,e,n,i));return r}}function rg(t,e,n,i,s){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let l=On(n,s?i:null),a=!1;l?a=!0:i instanceof R?(l=_s(n,i),a=!1):(l=R.EMPTY_NODE,a=!1);const c=Zn(new tt(l,a,!1),new tt(i,s,!1));return new Qm(e,c)}return o}function og(t,e,n,i,s,r){const o=rg(t,e,i,s,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Jm(o,n),eg(o,n)}function ag(t,e,n,i){const s=e._queryIdentifier,r=[];let o=[];const l=Ye(t);if(s==="default")for(const[a,c]of t.views.entries())o=o.concat(Br(c,n,i)),Ur(c)&&(t.views.delete(a),c.query._queryParams.loadsAllData()||r.push(c.query));else{const a=t.views.get(s);a&&(o=o.concat(Br(a,n,i)),Ur(a)&&(t.views.delete(s),a.query._queryParams.loadsAllData()||r.push(a.query)))}return l&&!Ye(t)&&r.push(new(ig())(e._repo,e._path)),{removed:r,events:o}}function Ga(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ht(t,e){let n=null;for(const i of t.views.values())n=n||Zm(i,e);return n}function Ya(t,e){if(e._queryParams.loadsAllData())return Jn(t);{const i=e._queryIdentifier;return t.views.get(i)}}function Ka(t,e){return Ya(t,e)!=null}function Ye(t){return Jn(t)!=null}function Jn(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kn;function lg(t){b(!kn,"__referenceConstructor has already been defined"),kn=t}function cg(){return b(kn,"Reference.ts has not been loaded"),kn}let ug=1;class zr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new U(null),this.pendingWriteTree_=Vm(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function dg(t,e,n,i,s){return Tm(t.pendingWriteTree_,e,n,i,s),s?Kt(t,new et(Fa(),e,n)):[]}function ct(t,e,n=!1){const i=Rm(t.pendingWriteTree_,e);if(Om(t.pendingWriteTree_,e)){let r=new U(null);return i.snap!=null?r=r.set(V(),!0):he(i.children,o=>{r=r.set(new W(o),!0)}),Kt(t,new Rn(i.path,r,n))}else return[]}function ei(t,e,n){return Kt(t,new et(ps(),e,n))}function hg(t,e,n){const i=U.fromObject(n);return Kt(t,new Wt(ps(),e,i))}function fg(t,e){return Kt(t,new jt(ps(),e))}function pg(t,e,n){const i=Cs(t,n);if(i){const s=Ss(i),r=s.path,o=s.queryId,l=ce(r,e),a=new jt(ms(o),l);return ws(t,r,a)}else return[]}function Vi(t,e,n,i,s=!1){const r=e._path,o=t.syncPointTree_.get(r);let l=[];if(o&&(e._queryIdentifier==="default"||Ka(o,e))){const a=ag(o,e,n,i);sg(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;if(l=a.events,!s){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(r,(h,f)=>Ye(f));if(u&&!d){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const f=_g(h);for(let p=0;p<f.length;++p){const m=f[p],g=m.query,_=Ja(t,m);t.listenProvider_.startListening(Mt(g),An(t,g),_.hashFn,_.onComplete)}}}!d&&c.length>0&&!i&&(u?t.listenProvider_.stopListening(Mt(e),null):c.forEach(h=>{const f=t.queryToTagMap.get(ti(h));t.listenProvider_.stopListening(Mt(h),f)}))}vg(t,c)}return l}function mg(t,e,n,i){const s=Cs(t,i);if(s!=null){const r=Ss(s),o=r.path,l=r.queryId,a=ce(o,e),c=new et(ms(l),a,n);return ws(t,o,c)}else return[]}function gg(t,e,n,i){const s=Cs(t,i);if(s){const r=Ss(s),o=r.path,l=r.queryId,a=ce(o,e),c=U.fromObject(n),u=new Wt(ms(l),a,c);return ws(t,o,u)}else return[]}function Gr(t,e,n,i=!1){const s=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(s,(h,f)=>{const p=ce(h,s);r=r||ht(f,p),o=o||Ye(f)});let l=t.syncPointTree_.get(s);l?(o=o||Ye(l),r=r||ht(l,V())):(l=new tg,t.syncPointTree_=t.syncPointTree_.set(s,l));let a;r!=null?a=!0:(a=!1,r=R.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((f,p)=>{const m=ht(p,V());m&&(r=r.updateImmediateChild(f,m))}));const c=Ka(l,e);if(!c&&!e._queryParams.loadsAllData()){const h=ti(e);b(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const f=yg();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}const u=gs(t.pendingWriteTree_,s);let d=og(l,e,n,u,r,a);if(!c&&!o&&!i){const h=Ya(l,e);d=d.concat(bg(t,e,h))}return d}function Qa(t,e,n){const s=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,l)=>{const a=ce(o,e),c=ht(l,a);if(c)return c});return Wa(s,e,r,n,!0)}function Kt(t,e){return Xa(e,t.syncPointTree_,null,gs(t.pendingWriteTree_,V()))}function Xa(t,e,n,i){if(M(t.path))return Za(t,e,n,i);{const s=e.get(V());n==null&&s!=null&&(n=ht(s,V()));let r=[];const o=A(t.path),l=t.operationForChild(o),a=e.children.get(o);if(a&&l){const c=n?n.getImmediateChild(o):null,u=Ha(i,o);r=r.concat(Xa(l,a,c,u))}return s&&(r=r.concat(bs(s,t,i,n))),r}}function Za(t,e,n,i){const s=e.get(V());n==null&&s!=null&&(n=ht(s,V()));let r=[];return e.children.inorderTraversal((o,l)=>{const a=n?n.getImmediateChild(o):null,c=Ha(i,o),u=t.operationForChild(o);u&&(r=r.concat(Za(u,l,a,c)))}),s&&(r=r.concat(bs(s,t,i,n))),r}function Ja(t,e){const n=e.query,i=An(t,n);return{hashFn:()=>(Xm(e)||R.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?pg(t,n._path,i):fg(t,n._path);{const r=pp(s,n);return Vi(t,n,null,r)}}}}function An(t,e){const n=ti(e);return t.queryToTagMap.get(n)}function ti(t){return t._path.toString()+"$"+t._queryIdentifier}function Cs(t,e){return t.tagToQueryMap.get(e)}function Ss(t){const e=t.indexOf("$");return b(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new W(t.substr(0,e))}}function ws(t,e,n){const i=t.syncPointTree_.get(e);b(i,"Missing sync point for query tag that we're tracking");const s=gs(t.pendingWriteTree_,e);return bs(i,n,s,null)}function _g(t){return t.fold((e,n,i)=>{if(n&&Ye(n))return[Jn(n)];{let s=[];return n&&(s=Ga(n)),he(i,(r,o)=>{s=s.concat(o)}),s}})}function Mt(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(cg())(t._repo,t._path):t}function vg(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const s=ti(i),r=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(r)}}}function yg(){return ug++}function bg(t,e,n){const i=e._path,s=An(t,e),r=Ja(t,n),o=t.listenProvider_.startListening(Mt(e),s,r.hashFn,r.onComplete),l=t.syncPointTree_.subtree(i);if(s)b(!Ye(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,d)=>{if(!M(c)&&u&&Ye(u))return[Jn(u).query];{let h=[];return u&&(h=h.concat(Ga(u).map(f=>f.query))),he(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<a.length;++c){const u=a[c];t.listenProvider_.stopListening(Mt(u),An(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Es(n)}node(){return this.node_}}class Is{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Q(this.path_,e);return new Is(this.syncTree_,n)}node(){return Qa(this.syncTree_,this.path_)}}const Cg=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Yr=function(t,e,n){if(!t||typeof t!="object")return t;if(b(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Sg(t[".sv"],e,n);if(typeof t[".sv"]=="object")return wg(t[".sv"],e);b(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Sg=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:b(!1,"Unexpected server value: "+t)}},wg=function(t,e,n){t.hasOwnProperty("increment")||b(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;typeof i!="number"&&b(!1,"Unexpected increment value: "+i);const s=e.node();if(b(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return typeof o!="number"?i:o+i},Eg=function(t,e,n,i){return xs(e,new Is(n,t),i)},Ig=function(t,e,n){return xs(t,new Es(e),n)};function xs(t,e,n){const i=t.getPriority().val(),s=Yr(i,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,l=Yr(o.getValue(),e,n);return l!==o.getValue()||s!==o.getPriority().val()?new Z(l,ae(s)):t}else{const o=t;return r=o,s!==o.getPriority().val()&&(r=r.updatePriority(new Z(s))),o.forEachChild(B,(l,a)=>{const c=xs(a,e.getImmediateChild(l),n);c!==a&&(r=r.updateImmediateChild(l,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}}function Rs(t,e){let n=e instanceof W?e:new W(e),i=t,s=A(n);for(;s!==null;){const r=ft(i.node.children,s)||{children:{},childCount:0};i=new Ts(s,i,r),n=H(n),s=A(n)}return i}function yt(t){return t.node.value}function el(t,e){t.node.value=e,$i(t)}function tl(t){return t.node.childCount>0}function xg(t){return yt(t)===void 0&&!tl(t)}function ni(t,e){he(t.node.children,(n,i)=>{e(new Ts(n,t,i))})}function nl(t,e,n,i){n&&!i&&e(t),ni(t,s=>{nl(s,e,!0,i)}),n&&i&&e(t)}function Tg(t,e,n){let i=t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Qt(t){return new W(t.parent===null?t.name:Qt(t.parent)+"/"+t.name)}function $i(t){t.parent!==null&&Rg(t.parent,t.name,t)}function Rg(t,e,n){const i=xg(n),s=Te(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,$i(t)):!i&&!s&&(t.node.children[e]=n.node,t.node.childCount++,$i(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og=/[\[\].#$\/\u0000-\u001F\u007F]/,Pg=/[\[\].#$\u0000-\u001F\u007F]/,bi=10*1024*1024,il=function(t){return typeof t=="string"&&t.length!==0&&!Og.test(t)},sl=function(t){return typeof t=="string"&&t.length!==0&&!Pg.test(t)},Ng=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sl(t)},Kr=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!is(t)||t&&typeof t=="object"&&Te(t,".sv")},rl=function(t,e,n,i){i&&e===void 0||Os(Hi(t,"value"),e,n)},Os=function(t,e,n){const i=n instanceof W?new Gp(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Qe(i));if(typeof e=="function")throw new Error(t+"contains a function "+Qe(i)+" with contents = "+e.toString());if(is(e))throw new Error(t+"contains "+e.toString()+" "+Qe(i));if(typeof e=="string"&&e.length>bi/3&&Dn(e)>bi)throw new Error(t+"contains a string greater than "+bi+" utf8 bytes "+Qe(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,r=!1;if(he(e,(o,l)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!il(o)))throw new Error(t+" contains an invalid key ("+o+") "+Qe(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Yp(i,o),Os(t,l,i),Kp(i)}),s&&r)throw new Error(t+' contains ".value" child '+Qe(i)+" in addition to actual children.")}},Ps=function(t,e,n,i){if(!sl(n))throw new Error(Hi(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Mg=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ps(t,e,n)},kg=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!il(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Ng(n))throw new Error(Hi(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ol(t,e){let n=null;for(let i=0;i<e.length;i++){const s=e[i],r=s.getPath();n!==null&&!ls(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(s)}n&&t.eventLists_.push(n)}function al(t,e,n){ol(t,n),ll(t,i=>ls(i,e))}function st(t,e,n){ol(t,n),ll(t,i=>be(i,e)||be(e,i))}function ll(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const s=t.eventLists_[i];if(s){const r=s.path;e(r)?(Lg(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Lg(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const i=n.getEventRunner();Rt&&oe("event: "+n.toString()),Gt(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg="repo_interrupt",Fg=25;class Vg{constructor(e,n,i,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ag,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Tn(),this.transactionQueueTree_=new Ts,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $g(t,e,n){if(t.stats_=os(t.repoInfo_),t.forceRestClient_||vp())t.server_=new xn(t.repoInfo_,(i,s,r,o)=>{Qr(t,i,s,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Xr(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ee(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Le(t.repoInfo_,e,(i,s,r,o)=>{Qr(t,i,s,r,o)},i=>{Xr(t,i)},i=>{Wg(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=wp(t.repoInfo_,()=>new Cm(t.stats_,t.server_)),t.infoData_=new gm,t.infoSyncTree_=new zr({startListening:(i,s,r,o)=>{let l=[];const a=t.infoData_.getNode(i._path);return a.isEmpty()||(l=ei(t.infoSyncTree_,i._path,a),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),Ns(t,"connected",!1),t.serverSyncTree_=new zr({startListening:(i,s,r,o)=>(t.server_.listen(i,r,s,(l,a)=>{const c=o(l,a);st(t.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{t.server_.unlisten(i,s)}})}function jg(t){const n=t.infoData_.getNode(new W(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function cl(t){return Cg({timestamp:jg(t)})}function Qr(t,e,n,i,s){t.dataUpdateCount++;const r=new W(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(i){const a=pn(n,c=>ae(c));o=gg(t.serverSyncTree_,r,a,s)}else{const a=ae(n);o=mg(t.serverSyncTree_,r,a,s)}else if(i){const a=pn(n,c=>ae(c));o=hg(t.serverSyncTree_,r,a)}else{const a=ae(n);o=ei(t.serverSyncTree_,r,a)}let l=r;o.length>0&&(l=ks(t,r)),st(t.eventQueue_,l,o)}function Xr(t,e){Ns(t,"connected",e),e===!1&&Ug(t)}function Wg(t,e){he(e,(n,i)=>{Ns(t,n,i)})}function Ns(t,e,n){const i=new W("/.info/"+e),s=ae(n);t.infoData_.updateSnapshot(i,s);const r=ei(t.infoSyncTree_,i,s);st(t.eventQueue_,i,r)}function Hg(t){return t.nextWriteId_++}function Ug(t){ul(t,"onDisconnectEvents");const e=cl(t),n=Tn();Mi(t.onDisconnect_,V(),(s,r)=>{const o=Eg(s,r,t.serverSyncTree_,e);Da(n,s,o)});let i=[];Mi(n,V(),(s,r)=>{i=i.concat(ei(t.serverSyncTree_,s,r));const o=Kg(t,s);ks(t,o)}),t.onDisconnect_=Tn(),st(t.eventQueue_,V(),i)}function Bg(t,e,n){let i;A(e._path)===".info"?i=Gr(t.infoSyncTree_,e,n):i=Gr(t.serverSyncTree_,e,n),al(t.eventQueue_,e._path,i)}function qg(t,e,n){let i;A(e._path)===".info"?i=Vi(t.infoSyncTree_,e,n):i=Vi(t.serverSyncTree_,e,n),al(t.eventQueue_,e._path,i)}function zg(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Dg)}function ul(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),oe(n,...e)}function dl(t,e,n){return Qa(t.serverSyncTree_,e,n)||R.EMPTY_NODE}function Ms(t,e=t.transactionQueueTree_){if(e||ii(t,e),yt(e)){const n=fl(t,e);b(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Gg(t,Qt(e),n)}else tl(e)&&ni(e,n=>{Ms(t,n)})}function Gg(t,e,n){const i=n.map(c=>c.currentWriteId),s=dl(t,e,i);let r=s;const o=s.hash();for(let c=0;c<n.length;c++){const u=n[c];b(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=ce(e,u.path);r=r.updateChild(d,u.currentOutputSnapshotRaw)}const l=r.val(!0),a=e;t.server_.put(a.toString(),l,c=>{ul(t,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(ct(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();ii(t,Rs(t.transactionQueueTree_,e)),Ms(t,t.transactionQueueTree_),st(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Gt(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{me("transaction at "+a.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}ks(t,e)}},o)}function ks(t,e){const n=hl(t,e),i=Qt(n),s=fl(t,n);return Yg(t,s,i),i}function Yg(t,e,n){if(e.length===0)return;const i=[];let s=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=ce(n,a.path);let u=!1,d;if(b(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,d=a.abortReason,s=s.concat(ct(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Fg)u=!0,d="maxretry",s=s.concat(ct(t.serverSyncTree_,a.currentWriteId,!0));else{const h=dl(t,a.path,o);a.currentInputSnapshot=h;const f=e[l].update(h.val());if(f!==void 0){Os("transaction failed: Data returned ",f,a.path);let p=ae(f);typeof f=="object"&&f!=null&&Te(f,".priority")||(p=p.updatePriority(h.getPriority()));const g=a.currentWriteId,_=cl(t),C=Ig(p,h,_);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=C,a.currentWriteId=Hg(t),o.splice(o.indexOf(g),1),s=s.concat(dg(t.serverSyncTree_,a.path,C,a.currentWriteId,a.applyLocally)),s=s.concat(ct(t.serverSyncTree_,g,!0))}else u=!0,d="nodata",s=s.concat(ct(t.serverSyncTree_,a.currentWriteId,!0))}st(t.eventQueue_,n,s),s=[],u&&(e[l].status=2,function(h){setTimeout(h,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(d==="nodata"?i.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):i.push(()=>e[l].onComplete(new Error(d),!1,null))))}ii(t,t.transactionQueueTree_);for(let l=0;l<i.length;l++)Gt(i[l]);Ms(t,t.transactionQueueTree_)}function hl(t,e){let n,i=t.transactionQueueTree_;for(n=A(e);n!==null&&yt(i)===void 0;)i=Rs(i,n),e=H(e),n=A(e);return i}function fl(t,e){const n=[];return pl(t,e,n),n.sort((i,s)=>i.order-s.order),n}function pl(t,e,n){const i=yt(e);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);ni(e,s=>{pl(t,s,n)})}function ii(t,e){const n=yt(e);if(n){let i=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[i]=n[s],i++);n.length=i,el(e,n.length>0?n:void 0)}ni(e,i=>{ii(t,i)})}function Kg(t,e){const n=Qt(hl(t,e)),i=Rs(t.transactionQueueTree_,e);return Tg(i,s=>{Ci(t,s)}),Ci(t,i),nl(i,s=>{Ci(t,s)}),n}function Ci(t,e){const n=yt(e);if(n){const i=[];let s=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(b(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(b(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(ct(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?el(e,void 0):n.length=r+1,st(t.eventQueue_,Qt(e),s);for(let o=0;o<i.length;o++)Gt(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(t){let e="";const n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let s=n[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Xg(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):me(`Invalid query segment '${n}' in query '${t}'`)}return e}const Zr=function(t,e){const n=Zg(t),i=n.namespace;n.domain==="firebase.com"&&Ve(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Ve("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||cp();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new ma(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new W(n.pathString)}},Zg=function(t){let e="",n="",i="",s="",r="",o=!0,l="https",a=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(l=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(s=Qg(t.substring(u,d)));const h=Xg(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),r=i}"ns"in h&&(r=h.ns)}return{host:e,port:a,domain:n,subdomain:i,secure:o,scheme:l,pathString:s,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n,i,s){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ee(this.snapshot.exportVal())}}class e_{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return b(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n,i,s){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=s}get key(){return M(this._path)?null:Ea(this._path)}get ref(){return new Ke(this._repo,this._path)}get _queryIdentifier(){const e=Lr(this._queryParams),n=ss(e);return n==="{}"?"default":n}get _queryObject(){return Lr(this._queryParams)}isEqual(e){if(e=Ht(e),!(e instanceof rt))return!1;const n=this._repo===e._repo,i=ls(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+zp(this._path)}}function ml(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function si(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===De){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Je)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==$e)throw new Error(i);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===B){if(e!=null&&!Kr(e)||n!=null&&!Kr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(b(t.getIndex()instanceof ds||t.getIndex()===ka,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function gl(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ke extends rt{constructor(e,n){super(e,n,new fs,!1)}get parent(){const e=xa(this._path);return e===null?null:new Ke(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ln{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new W(e),i=Jr(this.ref,e);return new Ln(this._node.getChild(n),i,B)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new Ln(s,Jr(this.ref,i),B)))}hasChild(e){const n=new W(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function b_(t,e){return t=Ht(t),t._checkNotDeleted("ref"),t._root}function Jr(t,e){return t=Ht(t),A(t._path)===null?Mg("child","path",e):Ps("child","path",e),new Ke(t._repo,Q(t._path,e))}class As{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const i=n._queryParams.getIndex();return new Jg("value",this,new Ln(e.snapshotNode,new Ke(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new e_(this,e,n):null}matches(e){return e instanceof As?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function n_(t,e,n,i,s){const r=new t_(n,void 0),o=new As(r);return Bg(t._repo,t,o),()=>qg(t._repo,t,o)}function C_(t,e,n,i){return n_(t,"value",e)}class ri{}class i_ extends ri{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){rl("endAt",this._value,e._path,!0);const n=mm(e._queryParams,this._value,this._key);if(gl(n),si(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function S_(t,e){return new i_(t,e)}class s_ extends ri{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){rl("startAfter",this._value,e._path,!1);const n=pm(e._queryParams,this._value,this._key);if(gl(n),si(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function w_(t,e){return new s_(t,e)}class r_ extends ri{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){ml(e,"orderByChild");const n=new W(this._path);if(M(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new ds(n),s=La(e._queryParams,i);return si(s),new rt(e._repo,e._path,s,!0)}}function E_(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ps("orderByChild","path",t),new r_(t)}class o_ extends ri{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){ml(e,"orderByKey");const n=La(e._queryParams,De);return si(n),new rt(e._repo,e._path,n,!0)}}function I_(){return new o_}function x_(t,...e){let n=Ht(t);for(const i of e)n=i._apply(n);return n}ng(Ke);lg(Ke);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="FIREBASE_DATABASE_EMULATOR_HOST",ji={};let l_=!1;function c_(t,e,n,i){t.repoInfo_=new ma(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function u_(t,e,n,i,s){let r=i||t.options.databaseURL;r===void 0&&(t.options.projectId||Ve("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),oe("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Zr(r,s),l=o.repoInfo,a;typeof process<"u"&&gr&&(a=gr[a_]),a?(r=`http://${a}?ns=${l.namespace}`,o=Zr(r,s),l=o.repoInfo):o.repoInfo.secure;const c=new bp(t.name,t.options,e);kg("Invalid Firebase Database URL",o),M(o.path)||Ve("Database URL must point to the root of a Firebase Database (not including a child path).");const u=h_(l,t,c,new yp(t.name,n));return new f_(u,t)}function d_(t,e){const n=ji[e];(!n||n[t.key]!==t)&&Ve(`Database ${e}(${t.repoInfo_}) has already been deleted.`),zg(t),delete n[t.key]}function h_(t,e,n,i){let s=ji[e.name];s||(s={},ji[e.name]=s);let r=s[t.toURLString()];return r&&Ve("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Vg(t,l_,n,i),s[t.toURLString()]=r,r}class f_{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($g(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ke(this._repo,V())),this._rootInternal}_delete(){return this._rootInternal!==null&&(d_(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ve("Cannot call "+e+" on a deleted database.")}}function T_(t=Al(),e){const n=Ml(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const i=kl("database");i&&p_(n,...i)}return n}function p_(t,e,n,i={}){t=Ht(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Ve("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let r;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Ve('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new fn(fn.OWNER);else if(i.mockUserToken){const o=typeof i.mockUserToken=="string"?i.mockUserToken:Ll(i.mockUserToken,t.app.options.projectId);r=new fn(o)}c_(s,e,n,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(t){ip(Gl),Dl(new Fl("database",(e,{instanceIdentifier:n})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return u_(i,s,r,n)},"PUBLIC").setMultipleInstances(!0)),$s(_r,vr,t),$s(_r,vr,"esm2017")}Le.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Le.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};m_();const R_=t=>{const e=y.useRef();return y.useEffect(()=>{e.current=t}),e.current};export{y_ as F,v_ as L,__ as P,C_ as a,E_ as b,S_ as e,T_ as g,I_ as o,x_ as q,b_ as r,w_ as s,R_ as u};
